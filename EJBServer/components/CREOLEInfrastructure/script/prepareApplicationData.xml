<?xml version="1.0" encoding="UTF-8"?>
<!--
  Prepare the application data prior to application start up.
-->
<project
  default="prepare.application.data"
  name="app_prepareapplicationdata"
>

  <property environment="sysenv."/>

  <!--  ***************************  -->
  <!--  ***  Import Properties  ***  -->
  <!--  ***************************  -->
  <import file="${sysenv.CURAMSDEJ}/bin/app_properties.xml"/>

  <path id="prepareapplicationdata.classpath">
    <path refid="tests.cp"/>
    <pathelement path="${jar.fscontext}"/>
    <pathelement path="${jar.providerutil}"/>
    <pathelement location="${prop.file.location}"/>
    <pathelement location="${dir.project.properties}"/>
    <pathelement path="${base.dir}/components/core/lib/PrepareApplicationData.jar"/>
  </path>


  <!--  ***********************************************************  -->
  <!--  ***   P R E P A R E   A P P L I C A T I O N   D A T A   ***  -->
  <!--  ***********************************************************  -->
  <target
    description="Prepare the Application Data"
    name="prepare.application.data"
  >


    <!-- Set the starting time stamp for use in file names -->
    <tstamp>
      <format
        pattern="yyyyMMddHHmmss"
        property="tim.start.sort"
      />
    </tstamp>


    <!-- Start recording progress to a log file -->
    <mkdir dir="${dir.bld.log}"/>
    <record
      loglevel="info"
      name="${dir.bld.log}/PrepareApplicationData${tim.start.sort}.log"
    />


    <!-- On zOS, put in noargsconversion -->
    <condition
      property="java.extra.jvmargs"
      value="-Xnoargsconversion"
    >
      <os family="z/os"/>
    </condition>
    <property
      name="java.extra.jvmargs"
      value="-Dfake.property=1"
    />


    <property
      name="prepareapplicationdata.program"
      value=" "
    />
    <property
      name="prepareapplicationdata.parameters"
      value=" "
    />
    <property
      name="prepareapplicationdata.username"
      value=" "
    />
    <property
      name="prepareapplicationdata.base.dir"
      value="${dir.bld.log}"
    />
    <property
      name="curam.disable.dynamic.properties"
      value="false"
    />


    <mkdir dir="${prepareapplicationdata.base.dir}"/>


    <!-- Prepare the Application Data -->
    <java
      classname="PrepareApplicationData"
      classpathref="prepareapplicationdata.classpath"
      dir="${prepareapplicationdata.base.dir}"
      failonerror="${java.failonerror}"
      fork="${java.fork}"
      maxmemory="${java.maxmemory}"
    >
      <sysproperty
        key="curam.disable.dynamic.properties"
        value="${curam.disable.dynamic.properties}"
      />
      <jvmarg value="${java.jvmargs}"/>
      <jvmarg value="${java.extra.jvmargs}"/>
      <!-- BEGIN, AI-51, RB -->
      <jvmarg value="-XX:MaxPermSize=256m"/>
      <!-- END, AI-51 -->
      <jvmarg value="-Dconsole.encoding=${java.console.encoding}"/>
      <jvmarg value="-Dfile.encoding=UTF-8"/>
      <jvmarg value="-Xbootclasspath/p:${jars.allxml}"/>
      <arg value="${prepareapplicationdata.program}"/>
      <arg value="${prepareapplicationdata.parameters}"/>
      <arg value="${prepareapplicationdata.username}"/>
      <arg value="${disable.database.callback}"/>
    </java>


  </target>


</project>
