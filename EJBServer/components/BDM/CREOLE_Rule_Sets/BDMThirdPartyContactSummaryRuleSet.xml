<?xml version="1.0" encoding="UTF-8"?>
<!-- 94324 DEV: Manage Third Party Evidence configuration -->
<RuleSet name="BDMThirdPartyContactSummaryRuleSet"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="http://www.curamsoftware.com/CreoleRulesSchema.xsd">

  <Class extends="DefaultEvidenceSummary"
    extendsRuleSet="EvidenceSummaryRuleSet" name="SummaryInformation">

    <Attribute name="evidence">
      <type>
        <ruleclass name="BDMThirdPartyContact"
          ruleset="BDMThirdPartyContactRuleSet" />
      </type>
      <derivation>
        <specified />
      </derivation>
    </Attribute>

    <Attribute name="summary">
      <type>
        <javaclass name="curam.creole.value.Message" />
      </type>
      <derivation>
        <choose>
            <type>
                <javaclass name="curam.creole.value.Message" />
            </type>
            <when>
                <condition>
                    <any>
                        <fixedlist>
                            <listof>
                                <javaclass name="Boolean" />
                            </listof>
                            <members>
                                <equals>
                                    <null/>
                                    <reference attribute="individualWithinOrg">
                                        <reference attribute="evidence" />
                                    </reference>
                                </equals>
                                <equals>
                                    <property name="length">
                                        <object>
                                            <reference attribute="individualWithinOrg">
                                                <reference attribute="evidence" />
                                            </reference>
                                        </object>
                                    </property>
                                    <Number value="0" />
                                </equals>
                            </members>
                        </fixedlist>
                    </any>
                </condition>
                <value>
                    <ResourceMessage key="SummaryMessage"
                      resourceBundle="curam.ca.gc.bdm.evidence.BDMThirdPartyContactSummaryRuleSet">
                      <reference attribute="thirdPartyConcernRoleName" />
                      <reference attribute="concernRoleName" />
                    </ResourceMessage>
                </value>
            </when>
            <otherwise>
                <value>
                    <ResourceMessage key="SummaryMessage"
                      resourceBundle="curam.ca.gc.bdm.evidence.BDMThirdPartyContactSummaryRuleSet">
                      <reference attribute="individualWithinOrg">
                        <reference attribute="evidence" />
                      </reference>
                      <reference attribute="concernRoleName" />
                    </ResourceMessage>
                </value>
            </otherwise>
        </choose>
      </derivation>
    </Attribute>

    <Attribute name="concernRoleName">
        <type>
            <javaclass name="String" />
        </type>
        <derivation>
            <call class="curam.ca.gc.bdm.creole.impl.Statics" method="getParticipantNameFromCaseParticipantRoleID">
                <type>
                    <javaclass name="String" />
                </type>
                <arguments>
                    <reference attribute="caseParticipantRole">
                        <reference attribute="evidence" />
                    </reference>
                </arguments>
            </call>
        </derivation>
    </Attribute>

    <Attribute name="thirdPartyConcernRoleName">
        <type>
            <javaclass name="String" />
        </type>
        <derivation>
            <call class="curam.ca.gc.bdm.creole.impl.Statics" method="getParticipantNameFromCaseParticipantRoleID">
                <type>
                    <javaclass name="String" />
                </type>
                <arguments>
                    <reference attribute="thirdPartyCaseParticipantRole">
                        <reference attribute="evidence" />
                    </reference>
                </arguments>
            </call>
        </derivation>
    </Attribute>

  </Class>

</RuleSet>
