<?xml version="1.0" encoding="UTF-8"?>
<RuleSet name="BDMTaxCreditSummaryRuleSet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="http://www.curamsoftware.com/CreoleRulesSchema.xsd">
	<Class extends="DefaultEvidenceSummary"
		extendsRuleSet="EvidenceSummaryRuleSet"
		name="BDMTaxCreditSummary">
		
		<!-- Evidence Information -->
		<Attribute name="evidence">
			<type>
				<ruleclass name="BDMTaxCredit"
					ruleset="BDMTaxCreditRuleSet" />
			</type>
			<derivation>
				<specified />
			</derivation>
		</Attribute>

		<!-- Message Preparation -->
		<Attribute name="summary">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="curam.creole.value.Message" />
					</type>
					
					<!-- Message: Native Status: Basic -->
					<when>
						<condition>
							<reference attribute="hasTaxCreditsValueBasicAndNativeStatusYes" />
						</condition>
						<value>
							<ResourceMessage key="summaryMessage1"
								resourceBundle="curam.bdm.pdc.rules.BDMTaxCreditSummaryRuleSet">
							</ResourceMessage>
						</value>
					</when>
					
					<!-- Message: Native Status: Basic And Spouse -->
					<when>
						<condition>
							<reference attribute="hasTaxCreditsValueBasicAndSpouseTaxAndNativeStatusYes" />
						</condition>
						<value>
							<ResourceMessage key="summaryMessage2"
								resourceBundle="curam.bdm.pdc.rules.BDMTaxCreditSummaryRuleSet">
							</ResourceMessage>
						</value>
					</when>
					
					<!-- Message: Basic -->
					<when>
						<condition>
							<reference attribute="hasTaxCreditsValueBasicAndNativeStatusNo" />
						</condition>
						<value>
							<ResourceMessage key="summaryMessage3"
								resourceBundle="curam.bdm.pdc.rules.BDMTaxCreditSummaryRuleSet">
							</ResourceMessage>
						</value>
					</when>
					
					<!-- Message: Basic And Spouse -->
					<when>
						<condition>
							<reference attribute="hasTaxCreditsValueBasicAndSpouseTaxAndNativeStatusNo" />
						</condition>
						<value>
							<ResourceMessage key="summaryMessage4"
								resourceBundle="curam.bdm.pdc.rules.BDMTaxCreditSummaryRuleSet">
							</ResourceMessage>
						</value>
					</when>
					
					<!-- Message: No Tax Credit Information -->
					<otherwise>
						<value>
							<ResourceMessage key="summaryMessage5"
								resourceBundle="curam.bdm.pdc.rules.BDMTaxCreditSummaryRuleSet">
							</ResourceMessage>
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		
		
		<!-- Verify whether Tax Credit value is Basic and Native Status is Yes -->
		<Attribute name="hasTaxCreditsValueBasicAndNativeStatusYes">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasNativeStatusValueYes" />
							<reference attribute="hasTaxCreditsValueBasic" />
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
		
		<!-- Verify whether Tax Credit value is Basic and Spouse Tax and Native Status is Yes -->
		<Attribute name="hasTaxCreditsValueBasicAndSpouseTaxAndNativeStatusYes">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasNativeStatusValueYes" />
							<reference attribute="hasTaxCreditsValueBasicAndSpouse" />
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
		
		<!-- Verify whether Tax Credit value is Basic and Native Status is No -->
		<Attribute name="hasTaxCreditsValueBasicAndNativeStatusNo">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasNativeStatusValueNo" />
							<reference attribute="hasTaxCreditsValueBasic" />
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
		
		<!-- Verify whether Tax Credit value is Basic and Spouse Tax and Native Status is No -->
		<Attribute name="hasTaxCreditsValueBasicAndSpouseTaxAndNativeStatusNo">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasNativeStatusValueNo" />
							<reference attribute="hasTaxCreditsValueBasicAndSpouse" />
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
	
			<!-- Confirm Tax Credit value is Basic -->
		<Attribute name="hasTaxCreditsValueBasic">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasTaxCreditValue" />
							<equals>
								<reference attribute="taxCredit">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMTaxSituation">
									<String value="Basic" />
								</Code>
	
							</equals>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
		
			<!-- Confirm Tax Credit value is Basic And Spouse-->
		<Attribute name="hasTaxCreditsValueBasicAndSpouse">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasTaxCreditValue" />
							<equals>
								<reference attribute="taxCredit">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMTaxSituation">
									<String value="Spouse" />
								</Code>
							</equals>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>

			<!-- Confirm Native Status value is Yes -->
		<Attribute name="hasNativeStatusValueYes">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="Boolean" />
						</listof>
						<members>
							<reference attribute="hasNativeStatusValue" />
							<equals>
								<reference attribute="nativeStatus">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMAlertsChoice">
									<String value="BDMDAC8002" />
								</Code>
	
							</equals>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>
		
		<!-- Confirm Native Status value is No -->
		<Attribute name="hasNativeStatusValueNo">
		<type>
			<javaclass name="Boolean" />
		</type>
		<derivation>
			<all>
				<fixedlist>
					<listof>
						<javaclass name="Boolean" />
					</listof>
					<members>
						<reference attribute="hasNativeStatusValue" />
						<equals>
							<reference attribute="nativeStatus">
								<reference attribute="evidence" />
							</reference>
							<Code table="BDMAlertsChoice">
								<String value="BDMDAC8001" />
							</Code>
	
						</equals>
					</members>
				</fixedlist>
			</all>
		</derivation>
			</Attribute>
		
		<!-- Verify whether Native Status value is mentioned or not -->
		<Attribute name="hasNativeStatusValue">
		  <type>
			<javaclass name="Boolean"/>
		  </type>
		  <derivation>
			<not>
			  <equals>
				<reference attribute="nativeStatus">
				  <reference attribute="evidence"/>
				</reference>
				<null/>
			  </equals>
			</not>
		  </derivation>
		</Attribute>
	
		<!-- Verify whether Tax Credit value is mentioned or not -->
		<Attribute name="hasTaxCreditValue">
		  <type>
			<javaclass name="Boolean"/>
		  </type>
		  <derivation>
			<not>
			  <equals>
				<reference attribute="taxCredit">
				  <reference attribute="evidence"/>
				</reference>
				<null/>
			  </equals>
			</not>
		  </derivation>
		</Attribute>

	</Class>
</RuleSet>
