<?xml version="1.0" encoding="UTF-8"?>

<ieg-script
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="ieg-schema.xsd"
	finish-page="cw/FinishAppealScript.jspx" 
	quit-page="cw/ExitIEGScript.jspx"
	show-sections="true" 
	show-progress-bar="true"
	validate-save-and-exit="false"
	config-properties="bdm-app-config"
	>
	
	


  <identifier id="BDMRequestForCallBack" scriptversionnumber="V1" type="REQUEST_FOR_CALLBACK" />
  
  
  <section>
    <title id="PersonalInformation.RFC.Title"><![CDATA[Personal Information]]></title>
   
    <callout expression="PrepopulateRequestForCallBackDetails()" id="Person.PrepopulateDetails" />
    <question-page id="PersonalInformation" progress="0" set-focus="true" show-back-button="false" show-exit-button="true" show-next-button="true" show-save-exit-button="false" entity="Person">
      <description id="MandatoryFieldsDescription">All fields are mandatory unless specified as optional.</description>
      <validation expression="ValidateCallBackRequestExists(CallBackDetails.programType)">
				      	<message id="CallBackDetails.Validation"><![CDATA[An active call back request already exists for the selected program]]></message>
	  </validation>
      <cluster>
        <title id="PersonalInformation.LanguagePreference"><![CDATA[Language Preference]]></title>
        <question control-question="false" id="contactLanguage" mandatory="true" multi-select="false" read-only-expression="true" show-field-help="false">
          <label id="PersonalInformation.LanguageCommunicationQuestion">The following language will be used when communicating with a representative:</label>
          <layout>
            <type>flow</type>
            <num-rows>1</num-rows>
          </layout>
          <codetable-hierarchy-layout hide-description="false" hide-label="false" show-path="false" vertical="true" />
        </question>
      </cluster>
      
      <cluster>
        <title id="PersonalInformation.ContactInformation"><![CDATA[Contact Information]]></title>
        <question control-question="false" id="firstName" mandatory="true" multi-select="false" read-only-expression="true" show-field-help="false">
          <label id="PersonalInformation.FName">First Name:</label>
          <layout>
            <type>flow</type>
            <label-width>0</label-width>
          </layout>
        </question>
        <question control-question="false" id="lastName" mandatory="true" multi-select="false" read-only-expression="true" show-field-help="false">
          <label id="PersonalInformation.FamName">Last Name:</label>
          <layout>
            <type>flow</type>
            <label-width>0</label-width>
          </layout>
        </question>
      </cluster>
      
     <cluster entity="CallBackDetails" >
			<title id="PersonalInformation.Program">
					<![CDATA[Program]]>
			</title>
            <question control-question="false" id="programType" mandatory="true">
          		<label id="PersonalInformation.ProgramQuestion"><![CDATA[What program do you want to discuss with a representative?]]></label>
          		<layout><type>radio</type></layout>
        	</question>
     </cluster>
    </question-page>
     <callout expression="SetRFCDetails()" id="SetRFCDetails" />
  </section>
  <section>
    <title id="CallBackDetails.RFC.Title"><![CDATA[Call back details]]></title>
    
    <question-page id="CallBackDetails" progress="33" set-focus="true" show-back-button="true" show-exit-button="true" show-next-button="true" show-save-exit-button="false" entity="CallBackDetails"  >
    
    
      <description id="MandatoryFieldsDescription">All fields are mandatory unless specified as optional.</description>
   
      <cluster entity="CallBackDetails" >
       <title id="CallBackDetails.RFC.Title">
					<![CDATA[Call back details]]>
				</title>
          <list-question entity="BenefitDetails"
                    id="benefitSelected" mandatory="false" show-field-help="false"
                    single-select="false" criteria="benefitType!=&quot;&quot;" 
                    display="dropdown">
                    <label id="CallBackDetails.BenefitEnquiryQuestion"><![CDATA[What Benefits are you enquiring about?]]></label>
                    <item-label>
                    <label-element attribute-id="benefitName"/>
                    </item-label>
         </list-question>
       </cluster>
       <cluster entity="CallBackDetails" >
        <question control-question="false" id="callBackSubject" mandatory="true" multi-select="false" show-field-help="false">
          <label id="CallBackDetails.CallBackSubjectQuestion"><![CDATA[Please indicate the subject for the call:]]></label>
        </question>
        <question control-question="false" id="callBackAdditionalDetails" mandatory="true" multi-select="false" show-field-help="false">
          <label id="CallBackDetails.CallBackMoreDetailsQuestion"><![CDATA[Please provide more details of the issue you want to discuss (maximum 300 characters)]]></label>
          <layout>
						<num-cols>1</num-cols>
						<num-rows>8</num-rows>
					</layout>
        </question>
      </cluster>
    </question-page>
 
   </section>
  
  <section>
    <title id="ContactInformation.RFC.Title"><![CDATA[Contact Information]]></title>
    
    <question-page id="ContactInformation" progress="66" set-focus="true" show-back-button="true" show-exit-button="true" show-next-button="true" show-save-exit-button="false" entity="Person">
  
  					<validation expression="ValidatePhoneNumber(Person.newcountryCode,Person.newphoneNumber)">
		      			<message id="ContactInformation.PhoneNumber.Validation"><![CDATA[Please provide a 7 digit phone number.]]></message>
		    		</validation>
		    		<validation expression="ValidatePhoneAreaCode(Person.newcountryCode,Person.newareaCode)">
				      	<message id="ContactInformation.AreaCode.Validation"><![CDATA[Please provide a 3 digit area code.]]></message>
				    </validation>
  					<validation expression="ValidatePhoneNumber(Person.altcountryCode,Person.altphoneNumber)">
		      			<message id="ContactInformation.PhoneNumber.Validation"><![CDATA[Please provide a 7 digit phone number.]]></message>
		    		</validation>
		    		<validation expression="ValidatePhoneAreaCode(Person.altcountryCode,Person.altareaCode)">
				      	<message id="ContactInformation.AreaCode.Validation"><![CDATA[Please provide a 3 digit area code.]]></message>
				    </validation>
				    <validation expression="validateEmailAddress(Person.altemailAdr,Person.altemailAdr)">
						<message id="ContactInformation.PEmail1.msg"><![CDATA[The email address is not valid.]]></message>
	    	        </validation>
  
  
    <description id="MandatoryFieldsDescription"><![CDATA[All fields are mandatory unless specified as optional.]]></description>
     
      <condition expression="Person.isExistingPhoneAvailable">
       <cluster>
        <title id="ContactInformation.Cluster.Title"><![CDATA[Contact Details]]></title>
        <question control-question="false" id="existingOrAddNewPhone" mandatory="true" multi-select="false" show-field-help="false">
          <label id="ContactInformation.ToBeContactedQuestion"><![CDATA[Would you like to be contacted at an existing phone number or add a new phone number?]]></label>
          <layout>
            <type>radio</type>
          </layout>
        </question>
      </cluster>
      </condition>


    <condition expression="Person.existingOrAddNewPhone==&quot;BDMBAC8001&quot;">
        <cluster>
          <list-question entity="PhoneNumber"
                    id="phoneSelected" mandatory="true" show-field-help="false"
                    single-select="true"  display="dropdown">
                    <label id="ContactInformation.ExistingPhoneNumberQuestion"><![CDATA[Select a phone number]]></label>
                    <item-label><label-element attribute-id="existingPhoneNumber"/></item-label>
                </list-question>
        </cluster>
     </condition> 
     
     
      <condition expression="Person.isExistingPhoneAvailable==false or Person.existingOrAddNewPhone==&quot;BDMBAC8000&quot;"> 
        <cluster>
         <display-text id="ContactInformation.AddNewContact.Title"/>
          <question control-question="false" id="newcountryCode" mandatory="true" multi-select="false" show-field-help="false">
            <label id="ContactInformation.PTelephoneCCode"><![CDATA[Country Code]]></label>
          </question>
        </cluster>
     </condition>  
<!--       <condition expression="(Person.existingOrAddNewPhone==&quot;BDMBAC8000&quot; or Person.existingPhoneNumber==&quot;&quot;) and Person.newcountryCode==&quot;CA&quot;"> 
 -->      
 	<condition expression="Person.newcountryCode==&quot;BDMPC80035&quot;"> 
      <cluster>
          <layout>
            <type>flow</type>
            <num-cols>2</num-cols>
          </layout>
          <container show-container-help="false">
            <question control-question="false" id="newareaCode" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PAreaCode1"><![CDATA[Area Code (555)]]></label>
            </question>
            <question control-question="false" id="newphoneNumber" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PTelephoneNumber1"><![CDATA[Phone Number (5551212)]]></label>
              <layout>
                <type>flow</type>
                <width>80</width>
              </layout>
            </question>
          </container>
        </cluster>
     </condition>
    <!--    <condition expression="(Person.existingOrAddNewPhone==&quot;BDMBAC8000&quot; or Person.existingPhoneNumber==&quot;&quot;) and Person.newcountryCode!=&quot;CA&quot;"> -->
    <condition expression="Person.newcountryCode!=&quot;&quot; and Person.newcountryCode!=&quot;BDMPC80035&quot;"> 
        <cluster>
          <layout>
            <type>flow</type>
            <num-cols>2</num-cols>
          </layout>
          <container show-container-help="false">
            <question control-question="false" id="newareaCode" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PAreaCode2"><![CDATA[Area Code]]></label>
            </question>
            <question control-question="false" id="newphoneNumber" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PTelephoneNumber2"><![CDATA[Phone Number]]></label>
              <layout>
                <type>flow</type>
                <width>80</width>
              </layout>
            </question>
          </container>
        </cluster>
         </condition> 
  <!--     </condition> -->
      <cluster>
        <question control-question="false" id="altPrefPhone" mandatory="false" multi-select="false" show-field-help="false">
          <label id="ContactInformation.AltPhoneQuestion"><![CDATA[Would you like to add an alternate phone number?]]></label>
          <layout>
            <type>radio</type>
          </layout>
        </question>
      </cluster>
     <condition expression="Person.altPrefPhone==&quot;YN1&quot;">
        <cluster>
         <display-text id="ContactInformation.Cluster.AltPhone"/>
          <question control-question="false" id="altcountryCode" mandatory="true" multi-select="false" show-field-help="false">
            <label id="ContactInformation.PTelephoneCCode"><![CDATA[Country Code]]></label>
          </question>
        </cluster>
     </condition>
     <!--   <condition expression="Person.altPrefPhone==&quot;YN1&quot; and Person.newcountryCode==&quot;CA&quot;"> -->
       <condition expression="Person.altcountryCode==&quot;BDMPC80035&quot;">
        <cluster>
          <layout>
            <type>flow</type>
            <num-cols>2</num-cols>
          </layout>
          <container show-container-help="false">
            <title id="Container.Title"></title>
            <question control-question="false" id="altareaCode" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PAreaCode1"><![CDATA[Area Code (555)]]></label>
            </question>
            <question control-question="false" id="altphoneNumber" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PTelephoneNumber1"><![CDATA[Phone Number (5551212)]]></label>
              <layout>
                <type>flow</type>
                <width>80</width>
              </layout>
            </question>
          </container>
        </cluster>
    </condition><!--   
      <condition expression="Person.altPrefPhone==&quot;YN1&quot; and Person.newcountryCode!=&quot;CA&quot;"> -->
      
       <condition expression=" Person.altcountryCode!=&quot;&quot; and Person.altcountryCode!=&quot;BDMPC80035&quot;">
        <cluster>
          <layout>
            <type>flow</type>
            <num-cols>2</num-cols>
          </layout>
          <container show-container-help="false">
            <question control-question="false" id="altareaCode" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PAreaCode2"><![CDATA[Area Code]]></label>
            </question>
            <question control-question="false" id="altphoneNumber" mandatory="true" multi-select="false" show-field-help="false">
              <label id="ContactInformation.PTelephoneNumber2"><![CDATA[Phone Number]]></label>
              <layout>
                <type>flow</type>
                <width>80</width>
              </layout>
            </question>
          </container>
        </cluster>
     </condition>
    
      <cluster>
        <title id="ContactInformation.Cluster.BestTimeToCall"><![CDATA[What is Best time to call you?]]></title>
        <question control-question="false" id="isMor" mandatory="false" multi-select="false" show-field-help="false">
          <label id="ContactInformation.Morning"><![CDATA[Mornings]]></label>
        </question>
        <question control-question="false" id="isAftr" mandatory="false" multi-select="false" show-field-help="false">
          <label id="ContactInformation.Afternoon"><![CDATA[Afternoons]]></label>
        </question>
        <question control-question="false" id="isEve" mandatory="false" multi-select="false" show-field-help="false">
          <label id="ContactInformation.Evening"><![CDATA[Evenings]]></label>
        </question>
        <question control-question="false" id="timeZone" mandatory="true" multi-select="false" show-field-help="false">
          <label id="ContactInformation.Timezone"><![CDATA[Please specify your time zone:]]></label>
        </question>
      </cluster>

     
     <condition expression="Person.isExistingEmailAvailable">
        <cluster>
	     <question control-question="false" id="existingOrAddNewEmail" mandatory="false" multi-select="false" show-field-help="false">
           <label id="ContactInformation.EmailAddress"><![CDATA[Would you like to use an existing email address or add a new email address?]]></label>
           <layout>
             <type>radio</type>
           </layout>
         </question>
        </cluster>
	 </condition>
	 
     <condition expression="Person.existingOrAddNewEmail==&quot;BDMBAC8001&quot;">
        <cluster>
          <list-question entity="EmailAddress"
                    id="emailSelected" mandatory="false" show-field-help="false"
                    single-select="true" display="dropdown">
                    <label id="ContactInformation.EmailAddressSelectQuestion"><![CDATA[Select an email address]]></label>
                    <item-label><label-element attribute-id="existingEmailAdr"/></item-label>
                </list-question>
        </cluster>
        
      </condition>
    <condition expression="Person.isExistingEmailAvailable==false or Person.existingOrAddNewEmail==&quot;BDMBAC8000&quot;">
        <cluster>
         <display-text id="ContactInformation.EmailAddressQuestionDesc"/>
          <question control-question="false" id="altemailAdr" mandatory="false" multi-select="false" read-only-expression="false" show-field-help="false">
            <label id="ContactInformation.EmailAddressQuestion"><![CDATA[Email Address]]></label>
          </question>
        </cluster>
      </condition>
     
     
      <cluster>
        <title id="ContactInformation.Cluster.AccessibilityDetails"><![CDATA[Accessibility Details]]></title>
        <question control-question="false" id="accessibilityDetails" mandatory="false" multi-select="false" show-field-help="false">
          <label id="ContactInformation.AccessibilityDetails"><![CDATA[Please describe any accessibility requirements, such as hearing impairment, for us to accomodate during a call. (Max 300 Characters)]]></label>
            <layout>
				<num-cols>2</num-cols>
				<num-rows>10</num-rows>
			</layout>
        </question>
      </cluster>
	  
    </question-page>
  </section>
 
 
 
  <section>
    <title id="Summary.Title"><![CDATA[Summary]]></title>
    <icon enabled-image="Request for Call Back Summary" />
    <summary-page id="Summary" progress="0" set-focus="true" show-back-button="true" show-exit-button="true" show-next-button="true" show-save-exit-button="false" >
      <title id="SummaryPage.Title"><![CDATA[Call back details]]></title>
      <next-button-label id="SummaryPage.NextButton.Label">Submit</next-button-label> 
      <cluster entity="Person" >
        <title id="PersonalInformation.RFC.Titlee"><![CDATA[Personal Information]]></title>
        <edit-link skip-to-summary="false" start-page="PersonalInformation" />
        <question control-question="false" id="contactLanguage" mandatory="false" multi-select="false" show-field-help="false">
          <label id="PersonalInformation.LanguageCommunicationQuestion"><![CDATA[Language to be used when communicating with a representative]]></label>
        </question>
      </cluster>
    
      <cluster entity="Person">
        <question control-question="false" id="firstName" >
          <label id="PersonalInformation.FName"><![CDATA[First given name]]></label>
        </question>
        <question control-question="false" id="lastName" >
          <label id="PersonalInformation.FamName"><![CDATA[Last name]]></label>
        </question>
      
       </cluster>  
        
       <cluster entity="CallBackDetails">
		<question id="programType">
				<label id="PersonalInformation.ProgramQuestion"><![CDATA[What program do you want to discuss with a representative?]]></label>
		</question>
         </cluster>
        
       <cluster entity="CallBackDetails"  > 
       	<title id="CallBackDetails.Cluster.Title"><![CDATA[Call Back Details]]></title>
        <edit-link skip-to-summary="false" start-page="CallBackDetails" />
        <list-question entity="BenefitDetails" id="benefitSelected" criteria="benefitType!=&quot;&quot;" >
              <label id="CallBackDetails.BenefitEnquiryQuestion"><![CDATA[What Benefits are you enquiring about?]]></label>
                    <item-label><label-element attribute-id="benefitName"/></item-label>
         </list-question>
       </cluster>
       
       <cluster entity="CallBackDetails" > 
        <question control-question="false" id="callBackSubject" >
          <label id="CallBackDetails.CallBackSubjectQuestion"><![CDATA[Please indicate the subject you would like to discuss:]]></label>
        </question>
     </cluster>
     
        <cluster entity="CallBackDetails" > 
        <question control-question="false" id="callBackAdditionalDetails" >
          <label id="CallBackDetails.CallBackMoreDetailsQuestion"><![CDATA[Please provide more details of the issue you wish to discuss (Maximim 300 characters):]]></label>
        </question>
     </cluster>
     
     
     
     <condition expression="isNotNull(Person.existingOrAddNewPhone) and Person.existingOrAddNewPhone==&quot;BDMBAC8001&quot;">
       <cluster  entity="Person" > 
        <title id="PersonalInformation.ContactInformation"><![CDATA[Contact Information]]></title>
          <edit-link skip-to-summary="false" start-page="ContactInformation" />
        <list-question entity="PhoneNumber"
                    id="phoneSelected" >
                    <label id="ContactInformation.ExistingPhoneNumberQuestion"><![CDATA[Select a phone number]]></label>
                    <item-label><label-element attribute-id="existingPhoneNumber"/></item-label>
         </list-question>
       </cluster>
         
     </condition>   
     
      <condition expression="isNotNull(Person.existingOrAddNewPhone) and (Person.existingOrAddNewPhone==&quot;BDMBAC8000&quot;) or not(isNotNull(Person.existingOrAddNewPhone))">  
        <cluster entity="Person">
           <title id="PersonalInformation.ContactInformation"><![CDATA[Contact Information]]></title>
           <edit-link skip-to-summary="false" start-page="ContactInformation" />
           <question control-question="false" id="newcountryCode" >
            <label id="ContactInformation.PTelephoneCCode"><![CDATA[Country code]]></label>
           </question>
           <question control-question="false" id="newareaCode" >
              <label id="ContactInformation.PAreaCode1"><![CDATA[Area code]]></label>
            </question>
           <question control-question="false" id="newphoneNumber" >
              <label id="ContactInformation.PTelephoneNumber1"><![CDATA[Phone number ]]></label>
            </question>
        </cluster>  
       </condition>
        
         
       <cluster entity="Person">
          <question control-question="false" id="altPrefPhone" >
          <label id="ContactInformation.AltPhoneQuestion"><![CDATA[Would you like to add an alternate phone number?]]></label>
          </question>
       </cluster>   
       
       <condition expression="isNotNull(Person.altPrefPhone) and Person.altPrefPhone==&quot;YN1&quot;">
        <cluster entity="Person">
           <question control-question="false" id="altcountryCode" >
            <label id="ContactInformation.PTelephoneCCode"><![CDATA[Country code]]></label>
          </question>
           
           <question control-question="false" id="altareaCode" >
              <label id="ContactInformation.PAreaCode1"><![CDATA[Area code]]></label>
            </question>
          
           <question control-question="false" id="altphoneNumber" >
              <label id="ContactInformation.PTelephoneNumber1"><![CDATA[Phone Number]]></label>
            </question>
        </cluster>
        </condition>
        
        <cluster entity="Person">
         <display-text id="ContactInformation.BestTimeToCall"/>
        <question control-question="false" id="isMor" >
          <label id="ContactInformation.Morning"><![CDATA[Mornings]]></label>
        </question>
        <question control-question="false" id="isAftr" >
          <label id="ContactInformation.Afternoon"><![CDATA[Afternoons]]></label>
        </question>
        <question control-question="false" id="isEve" >
          <label id="ContactInformation.Evening"><![CDATA[Evenings]]></label>
        </question>
        </cluster>
        
       <cluster entity="Person">
        <question control-question="false" id="timeZone" >
          <label id="ContactInformation.Timezone"><![CDATA[Please specify your time zone:]]></label>
        </question>
      </cluster>
       
      
      <condition expression="isNotNull(Person.existingOrAddNewEmail) and Person.existingOrAddNewEmail==&quot;BDMBAC8001&quot;">  
       
     <cluster entity="Person" >
          <list-question entity="EmailAddress"
                    id="emailSelected">
                    <label id="ContactInformation.EmailAddressSelectQuestion"><![CDATA[Select an email address]]></label>
                    <item-label><label-element attribute-id="existingEmailAdr"/></item-label>
          </list-question>
        </cluster>
      </condition>
      
      <condition expression="isNotNull(Person.existingOrAddNewEmail) and (Person.existingOrAddNewEmail==&quot;BDMBAC8000&quot;) or not(isNotNull(Person.existingOrAddNewEmail)) and Person.altemailAdr!=&quot;&quot; ">  
       <cluster entity="Person">
           <question control-question="false" id="altemailAdr" >
             <label id="ContactInformation.EmailAddress"><![CDATA[Please enter a new email address:]]></label>
          </question>
        </cluster>
        
      </condition>
      
        <cluster entity="Person">
           <question control-question="false" id="accessibilityDetails" >
           <label id="ContactInformation.AccessibilityDetails"><![CDATA[Please describe any accessibility requirements, such as hearing impairment, for us to accomodate during a call (Maximum 300 characters)]]></label>
        </question>
      </cluster>
  
  
	  
    </summary-page>
  </section>
</ieg-script>

