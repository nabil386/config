<?xml version="1.0" encoding="UTF-8"?>
<workflow-process id="80008" process-version="1"
	language-version="1.0" released="true" category="PC1" createdBy="admin"
	creationDate="20211220T144515">
	<name>BDMIntegrityTaskWorkflow</name>
	<process-display-name>
		<localized-text>
			<locale language="en">BDMIntegrityTaskWorkflow</locale>
		</localized-text>
	</process-display-name>
	<description>
		<localized-text>
			<locale language="en">Workflow housing a task for investigation of a bank account</locale>
		</localized-text>
	</description>
	<documentation>VSG10 Task Workflow</documentation>
	<enactment-mappings>
		<mapping>
			<source-attribute
				struct-name="curam.ca.gc.bdm.entity.struct.BDMBankAccountIntegrityDetails"
				name="accountNumber" />
			<target-attribute wdo-name="IntegrityTaskWDO"
				name="bankAccountNumber" />
		</mapping>
		<mapping>
			<source-attribute
				struct-name="curam.ca.gc.bdm.entity.struct.BDMBankAccountIntegrityDetails"
				name="transitNumber" />
			<target-attribute wdo-name="IntegrityTaskWDO"
				name="bankAccountTransitNumber" />
		</mapping>
		<mapping>
		  <source-attribute 
			struct-name="curam.ca.gc.bdm.entity.struct.BDMBankAccountIntegrityDetails" 
			name="workQueueID" />
		  <target-attribute wdo-name="IntegrityTaskWDO" 
			name="workQueueID" />
		</mapping>
		<mapping>
		  <source-attribute 
			struct-name="curam.ca.gc.bdm.entity.struct.BDMBankAccountIntegrityDetails" 
			name="bdmTaskClassificationID" />
		  <target-attribute wdo-name="IntegrityTaskWDO" 
			name="bdmTaskClassificationID" />
		</mapping>
		<mapping>
			<source-attribute
				struct-name="curam.ca.gc.bdm.entity.struct.BDMBankAccountIntegrityDetails"
				name="financialInstitutionNumber" />
			<target-attribute wdo-name="IntegrityTaskWDO"
				name="bankAccountFinancialInstitutionNumber" />
		</mapping>
		<mapping>
		  <source-attribute name="deadLineDurationInSec" struct-name="curam.ca.gc.bdm.rest.bdmuacaseworkerverificationtaskmanagerapi.struct.BDMUACaseWorkerVerificationEnactKey" />
		  <target-attribute wdo-name="IntegrityTaskWDO" name="deadLineInSec" />
		</mapping>
	</enactment-mappings>
	<wdos>
		<wdo is-list-wdo="false" initialize-attributes="false">
			<wdo-name>IntegrityTaskWDO</wdo-name>
			<display-name>
				<localized-text>
					<locale language="en">Integrity Task WDO</locale>
				</localized-text>
			</display-name>
			<attributes>
				<attribute>
					<attribute-name>bankAccountNumber</attribute-name>
					<display-name>
						<localized-text>
							<locale language="en">Bank Account Number</locale>
						</localized-text>
					</display-name>
					<type>STRING</type>
					<required-at-enactment>true</required-at-enactment>
					<process-output>false</process-output>
				</attribute>
				<attribute>
					<attribute-name>bankAccountTransitNumber</attribute-name>
					<display-name>
						<localized-text>
							<locale language="en">Bank Account Transit Number</locale>
						</localized-text>
					</display-name>
					<type>STRING</type>
					<required-at-enactment>true</required-at-enactment>
					<process-output>false</process-output>
				</attribute>
				<attribute>
					<attribute-name>bankAccountFinancialInstitutionNumber</attribute-name>
					<display-name>
						<localized-text>
							<locale language="en">Bank Account Financial Institution Number</locale>
						</localized-text>
					</display-name>
					<type>STRING</type>
					<required-at-enactment>true</required-at-enactment>
					<process-output>false</process-output>
				</attribute>
				<attribute>
				  <attribute-name>workQueueID</attribute-name>
				  <display-name>
					<localized-text>
					  <locale language="en">workQueueID</locale>
					</localized-text>
				  </display-name>
				  <type>INT64</type>
				  <required-at-enactment>true</required-at-enactment>
				  <process-output>false</process-output>
				</attribute>
				<attribute>
				  <attribute-name>bdmTaskClassificationID</attribute-name>
				  <display-name>
					<localized-text>
					  <locale language="en">bdmTaskClassificationID</locale>
					</localized-text>
				  </display-name>
				  <type>INT64</type>
				  <required-at-enactment>true</required-at-enactment>
				  <process-output>false</process-output>
				</attribute>
				<attribute>
				  <attribute-name>deadLineInSec</attribute-name>
				  <display-name>
					<localized-text>
					  <locale language="en">Deadline in Seconds</locale>
					</localized-text>
				  </display-name>
				  <type>INT32</type>
				  <required-at-enactment>true</required-at-enactment>
				  <process-output>false</process-output>
				</attribute>
			</attributes>
		</wdo>
	</wdos>
	<activities>
		<start-process-activity id="1">
			<name>
				<localized-text>
					<locale language="en">Start Process Activity</locale>
				</localized-text>
			</name>
			<description>
				<localized-text>
					<locale language="en">The start process activity</locale>
				</localized-text>
			</description>
			<split type="none">
				<transition-id idref="1" />
			</split>
		</start-process-activity>
		<end-process-activity id="2">
			<name>
				<localized-text>
					<locale language="en">End Process Activity</locale>
				</localized-text>
			</name>
			<description>
				<localized-text>
					<locale language="en">The end process activity</locale>
				</localized-text>
			</description>
			<join type="none" />
		</end-process-activity>
		<manual-activity id="3" category="AC1">
			<name>
				<localized-text>
					<locale language="en">Bank Account Integrity Task</locale>
				</localized-text>
			</name>
			<join type="none" />
			<split type="none">
				<transition-id idref="2" />
			</split>
			<task>
				<message>
					<message-text>
						<localized-text>
							<locale language="en">SP-VSG10 Bank account integrity review required for: Transit # %1s, FIN # %2s,  Account # %3s</locale>
						</localized-text>
					</message-text>
					<message-parameters>
						<wdo-attribute wdo-name="IntegrityTaskWDO"
							name="bankAccountTransitNumber" />
						<wdo-attribute wdo-name="IntegrityTaskWDO"
							name="bankAccountFinancialInstitutionNumber" />
						<wdo-attribute wdo-name="IntegrityTaskWDO"
							name="bankAccountNumber" />
					</message-parameters>
				</message>
				<task-priority>
					<priority>TP2</priority>
				</task-priority>
				<allow-deadline-override>false</allow-deadline-override>
				<allow-task-forwarding>true</allow-task-forwarding>
			</task>
			<allocation-strategy identifier="curam.core.sl.intf.WorkflowAllocationFunction.workQueueTaskAllocationStrategy" type="function">
				<function-mappings>
				  <formal-parameters>
					<formal-parameter index="0">
					  <struct type="curam.core.sl.struct.WorkQueueIDKey">
						<field name="workQueueID">
						  <base-type type="INT64">
							<wdo-attribute name="workQueueID" wdo-name="IntegrityTaskWDO" />
						  </base-type>
						</field>
					  </struct>
					</formal-parameter>
				  </formal-parameters>
				</function-mappings>
			</allocation-strategy>
			<event-wait wait-on-all-events="false">
				<events>
					<event identifier="1" event-class="TASK"
						event-type="CLOSED">
						<event-match-attribute wdo-name="Context_Task"
							name="taskID" />
					</event>
				</events>
				<deadline complete-activity="false">
				  <duration>
					<mapped-duration>
					  <wdo-attribute name="deadLineInSec" wdo-name="IntegrityTaskWDO" />
					</mapped-duration>
				  </duration>
				  <deadline-handler method-name="defaultDeadlineHandler" interface-name="curam.core.sl.intf.WorkflowDeadlineFunction">
					<formal-parameters>
					  <formal-parameter index="0">
						<struct type="curam.core.sl.struct.TaskCreateDetails">
						  <field name="subject">
							<base-type type="STRING" />
						  </field>
						  <field name="priority">
							<base-type type="STRING" />
						  </field>
						  <field name="assignedTo">
							<base-type type="STRING" />
						  </field>
						  <field name="assigneeType">
							<base-type type="STRING" />
						  </field>
						  <field name="deadlineDateTime">
							<base-type type="DATETIME" />
						  </field>
						  <field name="participantRoleID">
							<base-type type="INT64" />
						  </field>
						  <field name="participantType">
							<base-type type="STRING" />
						  </field>
						  <field name="caseID">
							<base-type type="INT64" />
						  </field>
						  <field name="reserveToMeInd">
							<base-type type="BOOLEAN" />
						  </field>
						  <field name="comments">
							<base-type type="STRING" />
						  </field>
						</struct>
					  </formal-parameter>
					</formal-parameters>
				  </deadline-handler>
				  <deadline-output-mappings />
				</deadline>
			</event-wait>
		    <biz-object-associations>
			  <biz-object-association biz-object-type="BDMBOT8000">
			    <wdo-attribute name="bdmTaskClassificationID" wdo-name="IntegrityTaskWDO" />
			  </biz-object-association>
		    </biz-object-associations>
		</manual-activity>
	</activities>
	<transitions>
		<transition id="1" from-activity-idref="1"
			to-activity-idref="3" />
		<transition id="2" from-activity-idref="3"
			to-activity-idref="2" />
	</transitions>
</workflow-process>

