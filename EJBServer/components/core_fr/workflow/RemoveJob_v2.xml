<?xml version="1.0" encoding="UTF-8"?>

<!--
  Licensed Materials - Property of IBM
  
  Copyright IBM Corporation 2012. All Rights Reserved.
  
  US Government Users Restricted Rights - Use, duplication or disclosure 
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->
<workflow-process category="PC1" createdBy="admin" creationDate="20121022T152245" id="1126999418470744" language-version="1.0" process-version="2" released="true"> 
  <name>RemoveJob</name>  
  <!--BEGIN, CR00361282, CL -->  
  <process-display-name> 
    <localized-text> 
      <locale language="fr">Retirer un emploi</locale>  
      <locale language="en">Remove Job</locale>
    </localized-text> 
  </process-display-name>  
  <!--END, CR00361282 -->  
  <description> 
    <localized-text> 
      <locale language="fr">Ce processus de flux de travaux assure le traitement lorsqu'un administrateur choisit de supprimer un emploi de la structure d'organisation.  Si des tâches sont affectées à l'emploi supprimé, une tâche est créée pour l'utilisateur principal de l'organisation afin de demander que la charge de travail soit réaffectée.</locale>  
      <locale language="en">This workflow process handles processing when an administrator chooses to delete a job from the organisation structure.  If there are tasks assigned to the deleted job, then a task is created for the organisation's lead user to request the workload be reassigned.</locale>
    </localized-text> 
  </description>  
  <enactment-mappings> 
    <mapping> 
      <source-attribute name="name" struct-name="curam.core.sl.entity.struct.JobDtls"/>  
      <target-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
    </mapping>  
    <mapping> 
      <source-attribute name="jobID" struct-name="curam.core.sl.entity.struct.JobDtls"/>  
      <target-attribute name="jobID" wdo-name="RemoveJobWDO"/> 
    </mapping>  
    <mapping> 
      <source-attribute name="organisationStructureID" struct-name="curam.core.sl.entity.struct.OrganisationStructureID"/>  
      <target-attribute name="organisationStructureID" wdo-name="RemoveJobWDO"/> 
    </mapping> 
  </enactment-mappings>  
  <wdos> 
    <wdo initialize-attributes="false" is-list-wdo="false"> 
      <wdo-name>RemoveJobWDO</wdo-name>  
      <display-name> 
        <localized-text> 
          <locale language="fr">RemoveJobWDO</locale>  
          <locale language="en">RemoveJobWDO</locale>
        </localized-text> 
      </display-name>  
      <attributes> 
        <attribute> 
          <attribute-name>isJobDeleted</attribute-name>  
          <display-name> 
            <localized-text> 
              <locale language="fr">isUserDeleted</locale>  
              <locale language="en">isUserDeleted</locale>
            </localized-text> 
          </display-name>  
          <type>BOOLEAN</type>  
          <required-at-enactment>false</required-at-enactment>  
          <process-output>false</process-output>  
          <initial-value>false</initial-value> 
        </attribute>  
        <attribute> 
          <attribute-name>jobName</attribute-name>  
          <display-name> 
            <localized-text> 
              <locale language="fr">jobName</locale>  
              <locale language="en">jobName</locale>
            </localized-text> 
          </display-name>  
          <type>STRING</type>  
          <required-at-enactment>true</required-at-enactment>  
          <process-output>false</process-output> 
        </attribute>  
        <attribute> 
          <attribute-name>jobID</attribute-name>  
          <display-name> 
            <localized-text> 
              <locale language="fr">jobID</locale>  
              <locale language="en">jobID</locale>
            </localized-text> 
          </display-name>  
          <type>INT64</type>  
          <required-at-enactment>true</required-at-enactment>  
          <process-output>false</process-output> 
        </attribute>  
        <attribute> 
          <attribute-name>organisationStructureID</attribute-name>  
          <display-name> 
            <localized-text> 
              <locale language="fr">organisationStructureID</locale>  
              <locale language="en">organisationStructureID</locale>
            </localized-text> 
          </display-name>  
          <type>INT64</type>  
          <required-at-enactment>true</required-at-enactment>  
          <process-output>false</process-output> 
        </attribute> 
      </attributes> 
    </wdo> 
  </wdos>  
  <activities> 
    <start-process-activity id="1"> 
      <name> 
        <localized-text> 
          <locale language="fr">Activité de processus de début</locale>  
          <locale language="en">Start Process Activity</locale>
        </localized-text> 
      </name>  
      <description> 
        <localized-text> 
          <locale language="fr">Activité du processus de début</locale>  
          <locale language="en">The start process activity</locale>
        </localized-text> 
      </description>  
      <split type="none"> 
        <transition-id idref="1"/> 
      </split> 
    </start-process-activity>  
    <end-process-activity id="2"> 
      <name> 
        <localized-text> 
          <locale language="fr">Activité du processus de fin</locale>  
          <locale language="en">End Process Activity</locale>
        </localized-text> 
      </name>  
      <description> 
        <localized-text> 
          <locale language="fr">Activité du processus de fin</locale>  
          <locale language="en">The end process activity</locale>
        </localized-text> 
      </description>  
      <join type="none"/> 
    </end-process-activity>  
    <automatic-activity category="AC1" id="3"> 
      <name> 
        <localized-text> 
          <locale language="fr">Retirer un emploi</locale>  
          <locale language="en">Remove Job</locale>
        </localized-text> 
      </name>  
      <join type="none"/>  
      <split type="xor"> 
        <transition-id idref="3"/>  
        <transition-id idref="4"/> 
      </split>  
      <bpo-mapping interface-name="curam.core.sl.intf.Job" method-name="cancelJobInWF"> 
        <formal-parameters> 
          <formal-parameter index="0"> 
            <struct type="curam.core.sl.struct.CancelJobKey"> 
              <field name="cancelJobKey"> 
                <struct type="curam.core.sl.entity.struct.JobKey"> 
                  <field name="jobID"> 
                    <base-type type="INT64"> 
                      <wdo-attribute name="jobID" wdo-name="RemoveJobWDO"/> 
                    </base-type> 
                  </field> 
                </struct> 
              </field> 
            </struct> 
          </formal-parameter> 
        </formal-parameters>  
        <return> 
          <struct> 
            <field name="isJobDeleted"> 
              <base-type> 
                <wdo-attribute name="isJobDeleted" wdo-name="RemoveJobWDO"/> 
              </base-type> 
            </field> 
          </struct> 
        </return> 
      </bpo-mapping> 
    </automatic-activity>  
    <manual-activity category="AC1" id="4"> 
      <name> 
        <localized-text> 
          <locale language="fr">Réaffecter des tâches de l'emploi</locale>  
          <locale language="en">Reassign Job Tasks</locale>
        </localized-text> 
      </name>  
      <notification delivery-mechanism="DM1"> 
        <subject> 
          <message> 
            <message-text> 
              <localized-text> 
                <locale language="fr">L'emploi %1s comprend au moins une tâche.</locale>  
                <locale language="en">The Job %1s has at least one task.</locale>
              </localized-text> 
            </message-text>  
            <message-parameters> 
              <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
            </message-parameters> 
          </message> 
        </subject>  
        <body> 
          <message> 
            <message-text> 
              <localized-text> 
                <locale language="fr">L'emploi %1s n'a pas pu être retiré, car une ou plusieurs tâches lui sont affectées. Une tâche a été créée et affectée à l'utilisateur principal de l'organisation pour demander que la charge de travail soit réaffectée.</locale>  
                <locale language="en">%1s could not be removed because task(s) are assigned to the job. A Task has been created and assigned to the Organisation's Lead User to request the workload be reassigned.</locale>
              </localized-text> 
            </message-text>  
            <message-parameters> 
              <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
            </message-parameters> 
          </message> 
        </body>  
        <allocation-strategy identifier="Supervisor" type="target"/> 
      </notification>  
      <join type="none"/>  
      <split type="none"> 
        <transition-id idref="9"/> 
      </split>  
      <task> 
        <message> 
          <message-text> 
            <localized-text> 
              <locale language="fr">Réallouez toutes les tâches affectées à l'emploi %1s, car il est marqué pour retrait.</locale>  
              <locale language="en">Reallocate all the tasks assigned to job %1s as it is marked for removal.</locale>
            </localized-text> 
          </message-text>  
          <message-parameters> 
            <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
          </message-parameters> 
        </message>  
        <actions> 
          <action open-modal="true" page-id="Organization_closeRemoveJobTask" principal-action="true"> 
            <message> 
              <message-text> 
                <localized-text> 
                  <locale language="fr">Confirmer la réallocation de la charge de travail</locale>  
                  <locale language="en">Confirm Workload Reallocation</locale>
                </localized-text> 
              </message-text> 
            </message>  
            <link-parameter name="jobName"> 
              <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
            </link-parameter>  
            <link-parameter name="taskID"> 
              <wdo-attribute name="taskID" wdo-name="Context_Task"/> 
            </link-parameter> 
          </action> 
        </actions>  
        <allow-deadline-override>false</allow-deadline-override>  
        <allow-task-forwarding>true</allow-task-forwarding> 
      </task>  
      <allocation-strategy identifier="curam.core.sl.intf.NotificationAllocationFunction.orgStructuresLeadUserStrategy" type="function"> 
        <function-mappings> 
          <formal-parameters> 
            <formal-parameter index="0"> 
              <base-type type="INT64"> 
                <wdo-attribute name="organisationStructureID" wdo-name="RemoveJobWDO"/> 
              </base-type> 
            </formal-parameter> 
          </formal-parameters> 
        </function-mappings> 
      </allocation-strategy>  
      <event-wait wait-on-all-events="false"> 
        <events> 
          <event event-class="TASK" event-type="CLOSED" identifier="1"> 
            <event-match-attribute name="taskID" wdo-name="Context_Task"/> 
          </event> 
        </events> 
      </event-wait> 
    </manual-activity>  
    <route-activity id="5"> 
      <name> 
        <localized-text> 
          <locale language="fr">Route 1</locale>  
          <locale language="en">Route 1</locale>
        </localized-text> 
      </name>  
      <description> 
        <localized-text> 
          <locale language="fr">Cette activité achemine le flux de la réaffectation de tâches de travail et d'activités de dossier ainsi que l'activité de notification de suppression afin de supprimer l'activité de boucle de travail.</locale>  
          <locale language="en">This activity routes the flow from reassign job tasks activity and route with delete notification activity to remove job loop activity.</locale>
        </localized-text> 
      </description>  
      <join type="xor"/>  
      <split type="none"> 
        <transition-id idref="7"/> 
      </split> 
    </route-activity>  
    <route-activity category="AC1" id="9"> 
      <name> 
        <localized-text> 
          <locale language="fr">Route avec notification de suppression</locale>  
          <locale language="en">Route with delete notification</locale>
        </localized-text> 
      </name>  
      <description> 
        <localized-text> 
          <locale language="fr">Cette activité envoie une notification de suppression une fois le travail supprimé.</locale>  
          <locale language="en">This activity sends a delete notification after the job is removed.</locale>
        </localized-text> 
      </description>  
      <notification delivery-mechanism="DM1"> 
        <subject> 
          <message> 
            <message-text> 
              <localized-text> 
                <locale language="fr">L'emploi %1s a été retiré avec succès.</locale>  
                <locale language="en">The Job %1s has been removed successfully.</locale>
              </localized-text> 
            </message-text>  
            <message-parameters> 
              <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
            </message-parameters> 
          </message> 
        </subject>  
        <body> 
          <message> 
            <message-text> 
              <localized-text> 
                <locale language="fr">Le système a terminé avec succès le processus de retrait de l'emploi %1s.</locale>  
                <locale language="en">The system successfully completed the process of removing Job %1s.</locale>
              </localized-text> 
            </message-text>  
            <message-parameters> 
              <wdo-attribute name="jobName" wdo-name="RemoveJobWDO"/> 
            </message-parameters> 
          </message> 
        </body>  
        <allocation-strategy identifier="Supervisor" type="target"/> 
      </notification>  
      <join type="none"/>  
      <split type="none"> 
        <transition-id idref="10"/> 
      </split> 
    </route-activity>  
    <loop-begin-activity id="7"> 
      <name> 
        <localized-text> 
          <locale language="fr">Boucle de retrait de l'emploi [Début]</locale>  
          <locale language="en">Remove Job Loop [Begin]</locale>
        </localized-text> 
      </name>  
      <join type="none"/>  
      <split type="none"> 
        <transition-id idref="2"/> 
      </split>  
      <loop-type name="while"/>  
      <condition> 
        <expression conjunction="and" data-item-lhs="RemoveJobWDO.isJobDeleted" data-item-rhs="false" id="1" operation="=="/> 
      </condition>  
      <block-endpoint-ref activity-id="8"/> 
    </loop-begin-activity>  
    <loop-end-activity id="8"> 
      <name> 
        <localized-text> 
          <locale language="fr">Boucle de retrait de l'emploi [Fin]</locale>  
          <locale language="en">Remove Job Loop [End]</locale>
        </localized-text> 
      </name>  
      <join type="none"/>  
      <split type="none"> 
        <transition-id idref="8"/> 
      </split>  
      <block-endpoint-ref activity-id="7"/> 
    </loop-end-activity> 
  </activities>  
  <transitions> 
    <transition from-activity-idref="1" id="1" to-activity-idref="7"/>  
    <transition from-activity-idref="7" id="2" to-activity-idref="3"/>  
    <transition from-activity-idref="3" id="3" to-activity-idref="4"> 
      <condition> 
        <expression conjunction="and" data-item-lhs="RemoveJobWDO.isJobDeleted" data-item-rhs="false" id="1" operation="=="/> 
      </condition> 
    </transition>  
    <transition from-activity-idref="3" id="4" to-activity-idref="9"/>  
    <transition from-activity-idref="5" id="7" to-activity-idref="8"/>  
    <transition from-activity-idref="8" id="8" to-activity-idref="2"/>  
    <transition from-activity-idref="4" id="9" to-activity-idref="5"/>  
    <transition from-activity-idref="9" id="10" to-activity-idref="5"/> 
  </transitions> 
</workflow-process>
