<?xml version="1.0" encoding="UTF-8"?>
 
<ieg-script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="ieg-schema.xsd"
finish-page="CommonIntake_finishInternalIntakeScript" 
	quit-page="CommonIntake_quitInternalIntakeScript"	
	show-sections="true"
	show-progress-bar="true"
	validate-save-and-exit="false"
	>
		
	<identifier id="BDMOASGISApplicationAP" scriptversionnumber="V1" type="Intake" />

	<section>
		<title id="Section.Title.PartnerIncome">
			<![CDATA[Spouse/Common-Law Partner Income]]>
		</title>

		<loop loop-type="for-each" entity="Person"
			criteria="isPrimaryParticipant==false">	
			<question-page 
				id="PartnerIncome" 
				entity="Person"
				progress="0" 
				show-back-button="true" 
				show-exit-button="true"
				criteria="isPrimaryParticipant==false"			
				>
				<title id="QuestionPage.Title.PartnerIncome">
					<![CDATA[Income Details]]>
				</title>
				
				<description id="QuestionPage.Description.MandatoryFields">
					<![CDATA[All fields marked with * are mandatory.]]>
				</description>		
				
				<set-attribute expression="getPreviousYear()" id="Income.previousYear" />	
	
				<validation expression="not(isNotNull(RetirementIncome.retirementDate)) or ValidateDateFirstOfMonth(RetirementIncome.retirementDate)">
					<message id="Validation.Message.DateFirstOfMonth"><![CDATA[Selected Date must be 1st of the month.]]></message>
				</validation>	
	
				<validation expression="not(isNotNull(RetirementIncome.reductionDate)) or ValidateDateFirstOfMonth(RetirementIncome.reductionDate)">
					<message id="Validation.Message.DateFirstOfMonth"><![CDATA[Selected Date must be 1st of the month.]]></message>
				</validation>	
	
				<condition expression="Application.applicationForm!=&quot;AF4&quot; and Application.applicationForm!=&quot;AF5&quot; and Application.applicationForm!=&quot;AF6&quot; ">
				<cluster entity="RetirementIncome">
					<title id="Cluster.Title.RetirementIncomeDetails">
						<![CDATA[Retirement Income details]]>
					</title>
					<question id="isRetirdOrRetirng2Yrs">
						<label id="Question.Label.DidRetireOrExpctedIn2Years">
							<![CDATA[Did the applicant indicate that their spouse/common-law partner retired from work in the last two years, or that they expect to retire in the next two years?]]>
						</label>
						<layout>
							<width>50</width>							
						</layout>							
					</question>						
				</cluster>
				</condition>	
						
				<condition expression="RetirementIncome.isRetirdOrRetirng2Yrs==&quot;YN1&quot; and Application.applicationForm!=&quot;AF4&quot; and Application.applicationForm!=&quot;AF5&quot; and Application.applicationForm!=&quot;AF6&quot; ">
					<cluster entity="RetirementIncome">
						<question id="retirementDate" mandatory="true" show-field-help="true">
							<label id="Question.Label.RetirementDate">
								<![CDATA[Retirement Date]]>
							</label>
							<help-text id="Question.Label.RetirementDate.Help">
								<![CDATA[YYYY-MM-DD </br><p>Selected Date must be 1st of the month.</p>]]>
							</help-text>
							<layout>
								<width>50</width>							
							</layout>														
						</question>		
					</cluster>
				</condition>
	
			<condition expression="Application.applicationForm!=&quot;AF4&quot; and Application.applicationForm!=&quot;AF5&quot; and Application.applicationForm!=&quot;AF6&quot; ">
				<cluster entity="RetirementIncome">
					<question id="isPensionReduced2Yrs">
						<label id="Question.Label.DidPensionIncmRedcdOrExpectedIn2Yrs">
							<![CDATA[Has the applicant indicated that their spouse/common-law partner's pension income has been reduced in the last two years or that they expect it will be reduced in the next two years?]]>
						</label>
						<layout>
							<width>50</width>							
						</layout>							
					</question>						
				</cluster>
			</condition>	
						
				<condition expression="RetirementIncome.isPensionReduced2Yrs==&quot;YN1&quot; and Application.applicationForm!=&quot;AF4&quot; and Application.applicationForm!=&quot;AF5&quot; and Application.applicationForm!=&quot;AF6&quot; ">
					<cluster entity="RetirementIncome">
						<question id="reductionDate" mandatory="true" show-field-help="true">
							<label id="Question.Label.DateOfReduction">
								<![CDATA[Date of reduction]]>
							</label>
							<help-text id="Question.Label.DateOfReduction.Help">
								<![CDATA[YYYY-MM-DD </br><p>Selected Date must be 1st of the month.</p>]]>
							</help-text>
							<layout>
								<width>50</width>							
							</layout>														
						</question>		
					</cluster>
				</condition>										
	
			<condition expression="Application.applicationForm!=&quot;AF3&quot;">
				<cluster entity="ForeignIncome">
					<title id="Cluster.Title.ForeignIncomeDetails">
						<![CDATA[Foreign Income details]]>
					</title>
					<question id="isReceivingForeignIncome">
						<label id="Question.Label.DidReceiveForeignIncome">
							<![CDATA[Did the applicant indicate that their spouse/common-law partner receives income from another country?]]>
						</label>
						<layout>
							<width>50</width>							
						</layout>							
					</question>						
				</cluster>
			</condition>	
				
				<condition expression="ForeignIncome.isReceivingForeignIncome==&quot;YN1&quot; and Application.applicationForm!=&quot;AF3&quot;">
					<cluster entity="ForeignIncome">
						<question id="foreignIncomeType" mandatory="true">
							<label id="Question.Label.TypeOfForeignIncome">
								<![CDATA[Type of Foreign Income]]>
							</label>
							<layout>
								<width>50</width>							
							</layout>									
						</question>		
					</cluster>
				</condition>
						
				<condition expression="ForeignIncome.isReceivingForeignIncome==&quot;YN1&quot; and Application.applicationForm!=&quot;AF3&quot;">
					<cluster entity="ForeignIncome">
						<question id="annualForeignIncomeStr" mandatory="true">
							<label id="Question.Label.AnnualForeignIncome">
								<![CDATA[Annual Foreign Income Amount & Currency]]>
							</label>
							<layout>
								<width>50</width>							
							</layout>									
						</question>		
					</cluster>
				</condition>									
			</question-page>

			<condition expression="Application.applicationForm==&quot;AF3&quot;">		
				<question-page 
					id="PartnerReportedIncome" 
					entity="Person"
					progress="0" 
					show-back-button="true" 
					show-exit-button="true"
					criteria="isPrimaryParticipant==false"			
					>
					<title id="QuestionPage.Title.PartnerReportedIncome">
						<![CDATA[Spouse/Common-Law Partner's Manually Reported Income]]>
					</title>
					
					<description id="QuestionPage.Description.MandatoryFields">
						<![CDATA[All fields marked with * are mandatory.]]>
					</description>		
					
					<validation expression="not(isNotNull(Income.incomeYear)) or ValidateIncomeYear(Income.incomeYear)">
						<message id="Validation.Message.YrBetween1967AndPrevYear"><![CDATA['Year' must be a whole number between 1967 and %1s.]]>
							<argument id = "Income.previousYear"/>
						</message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.incomeYear) and isNotNull(Person.dateOfBirth)) or ValidateIncomeYearBeforeBirthYear(Income.incomeYear, Person.dateOfBirth)">
						<message id="Validation.Message.YrCanNotBeBeforeBirthYearYear"><![CDATA[A Manually Reported Income year cannot be before year of birth.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.incomeYear) and isNotNull(Person.dateOfDeath)) or ValidateIncomeYearBeforeBirthYear(Income.incomeYear,Person.dateOfDeath)">
						<message id="Validation.Message.YrCanNotBeBeforeDeathYearYear"><![CDATA[A Manually Reported Income year cannot be after year of death.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.capitalGainsAmount)) or ValidateIncomeAmount(Income.capitalGainsAmount)">
						<message id="Validation.Message.CapitalGainsAmountCanNotBeANegativeAmount"><![CDATA[Capital Gains cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.cppOrQPPAmount)) or ValidateIncomeAmount(Income.cppOrQPPAmount)">
						<message id="Validation.Message.CPPOrQppAmountCanNotBeANegativeAmount"><![CDATA[Canada Pension Plan or Quebec Pension Plan benefits  cannot be a negative amount. ]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.dividendsAmount)) or ValidateIncomeAmount(Income.dividendsAmount)">
						<message id="Validation.Message.DividendAmountCanNotBeANegativeAmount"><![CDATA[Eligible and other than eligible dividends cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.eiAmount)) or ValidateIncomeAmount(Income.eiAmount)">
						<message id="Validation.Message.EIAmountCanNotBeANegativeAmount"><![CDATA[Employment Insurance cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.frgnPensionAmount)) or ValidateIncomeAmount(Income.frgnPensionAmount)">
						<message id="Validation.Message.FrgnPensionAmountCanNotBeANegativeAmount"><![CDATA[Foreign pension income cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.interestAndInvstAmount)) or ValidateIncomeAmount(Income.interestAndInvstAmount)">
						<message id="Validation.Message.InterestAmountCanNotBeANegativeAmount"><![CDATA[Interest and other investment income cannot be a negative amount. ]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.netEmploymentAmount)) or ValidateIncomeAmount(Income.netEmploymentAmount)">
						<message id="Validation.Message.NetEmploymentIncmAmountCanNotBeANegativeAmount"><![CDATA[Net employment income cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.othrCAPensionAmount)) or ValidateIncomeAmount(Income.othrCAPensionAmount)">
						<message id="Validation.Message.OtherCAPensionAmountCanNotBeANegativeAmount"><![CDATA[Other Canadian pension income cannot be a negative amount.]]></message>
					</validation>	
		
					<validation expression="not(isNotNull(Income.wcbAmount)) or ValidateIncomeAmount(Income.wcbAmount)">
						<message id="Validation.Message.WCBAmountCanNotBeANegativeAmount"><![CDATA[Workers' compensation benefits cannot be a negative amount. ]]></message>
					</validation>	
		
					<cluster entity="Income">
						<title id="Cluster.Title.ManuallyReportedIncomeYear">
							<![CDATA[Manually Reported Income Year]]>
						</title>
						<description id="Cluster.Title.ManuallyReportedIncomeYear.Description">
							<![CDATA[Enter Income details for Spouse/ Common-Law partner]]>
						</description>				
						<question id="incomeYear">
							<label id="Question.Label.ManuallyReportedIncomeYear">
								<![CDATA[Year]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block1">
							<![CDATA[Block 1]]>
						</title>		
						<question id="cppOrQPPAmount">
							<label id="Question.Label.CPPOrQPPBenefits">
								<![CDATA[Canada Pension Plan or Quebec Pension Plan benefits ]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>			
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block2">
							<![CDATA[Block 2]]>
						</title>		
						<question id="othrCAPensionAmount">
							<label id="Question.Label.OtherCAPensionIncome">
								<![CDATA[Other Canadian pension income]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>	
						<question id="frgnPensionAmount">
							<label id="Question.Label.ForeignPensionIncome">
								<![CDATA[Foreign pension income]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>									
					</cluster>				
		
					<cluster entity="Income">
						<title id="Cluster.Title.Block3">
							<![CDATA[Block 3]]>
						</title>		
						<question id="eiAmount">
							<label id="Question.Label.EmploymentInsurance">
								<![CDATA[Employment Insurance]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>
						<question id="wcbAmount">
							<label id="Question.Label.Workerscompensationbenefits">
								<![CDATA[Workers' compensation benefits ]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>										
					</cluster>	
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block4">
							<![CDATA[Block 4]]>
						</title>		
						<question id="interestAndInvstAmount">
							<label id="Question.Label.InterestAndOtherInvestmentIncome">
								<![CDATA[Interest and other investment income]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>							
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block5">
							<![CDATA[Block 5]]>
						</title>		
						<question id="dividendsAmount">
							<label id="Question.Label.EligibleAndOtherDividends">
								<![CDATA[Eligible and other than eligible dividends]]>
							</label>
							<layout>
								<label-width>0</label-width>									
								<width>50</width>							
							</layout>							
						</question>	
						<question id="capitalGainsAmount">
							<label id="Question.Label.CapitalGains">
								<![CDATA[Capital Gains]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>									
					</cluster>	
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block6">
							<![CDATA[Block 6]]>
						</title>		
						<question id="netRentalAmount">
							<label id="Question.Label.NetRentalIncome">
								<![CDATA[Net rental income ]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>	
		
					<cluster entity="Income">
						<title id="Cluster.Title.Block7">
							<![CDATA[Block 7]]>
						</title>		
						<question id="netEmploymentAmount">
							<label id="Question.Label.NetEmploymentIncome">
								<![CDATA[Net employment income ]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>	
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block8">
							<![CDATA[Block 8]]>
						</title>		
						<question id="netSelfEmploymentAmount">
							<label id="Question.Label.NetSelfEmploymentIncome">
								<![CDATA[Year]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>						
					</cluster>	
					
					<cluster entity="Income">
						<title id="Cluster.Title.Block9">
							<![CDATA[Block 9]]>
						</title>		
						<question id="incomeSource">
							<label id="Question.Label.Source">
								<![CDATA[Source]]>
							</label>
							<layout>
								<label-width>0</label-width>	
								<width>50</width>							
							</layout>							
						</question>	
						<question id="otherIncmAmount">
							<label id="Question.Label.OtherIncome">
								<![CDATA[Other Income]]>
							</label>
							<layout>
								<label-width>0</label-width>							
								<width>50</width>							
							</layout>							
						</question>									
					</cluster>										
				</question-page>								
			</condition>
		</loop>
	</section>
</ieg-script>
