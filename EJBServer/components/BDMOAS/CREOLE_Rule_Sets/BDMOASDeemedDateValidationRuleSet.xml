<RuleSet name="BDMOASDeemedDateValidationRuleSet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="../../../build/svr/creole.gen/schema/RuleSet.xsd">
	<Class extends="DefaultEvidenceValidationResult"
		extendsRuleSet="EvidenceValidationRuleSet" name="ValidationResult">
		<Attribute name="evidence">
			<type>
				<ruleclass name="BDMOASDeemedDate"
					ruleset="BDMOASDeemedDateRuleSet" />
			</type>
			<derivation>
				<specified />
			</derivation>
		</Attribute>
		<Attribute name="standardValidations">
			<type>
				<javaclass name="java.util.List">
					<ruleclass name="Validation"
						ruleset="EvidenceValidationRuleSet" />
				</javaclass>
			</type>
			<derivation>
				<fixedlist>
					<listof>
						<ruleclass name="Validation"
							ruleset="EvidenceValidationRuleSet" />
					</listof>
					<members>
						<reference attribute="singleInstanceValidation" />
						<reference attribute="singleProtectiveDateValidation" />
						<reference attribute="reasonLengthValidation" />
						<reference attribute="protectiveDateValidation" />
					</members>
				</fixedlist>
			</derivation>
		</Attribute>
		<Attribute name="singleInstanceValidation">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="singleInstanceFailure" />
					<reference attribute="singleInstanceFailureMessage" />
				</create>
			</derivation>
		</Attribute>
		<Attribute name="singleInstanceFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="java.lang.Boolean" />
					</type>
					<when>
						<condition>
							<equals>
								<reference attribute="deemedDateReason">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMOASDeemedDateReason">
									<String value="DDR4" />
								</Code>
							</equals>
						</condition>
						<value>
							<false />
						</value>
					</when>
					<when>
						<condition>
							<equals>
								<reference attribute="deemedDateReason">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMOASDeemedDateReason">
									<String value="DDR5" />
								</Code>
							</equals>
						</condition>
						<value>
							<false />
						</value>
					</when>
					<otherwise>
						<value>
							<any>
								<dynamiclist>
									<list>
										<reference attribute="deemedDateRecords"></reference>
									</list>
									<listitemexpression>
										<all>
											<fixedlist>
												<listof>
													<javaclass name="java.lang.Boolean" />
												</listof>
												<members>
													<not>
														<equals>
															<reference attribute="successionID">
																<current />
															</reference>
															<reference attribute="successionID">
																<reference attribute="evidence" />
															</reference>
														</equals>
													</not>
													<not>
														<equals>
															<reference attribute="deemedDateReason">
																<reference attribute="evidence" />
															</reference>
															<Code table="BDMOASDeemedDateReason">
																<String value="DDR4" />
															</Code>
														</equals>
													</not>
													<not>
														<equals>
															<reference attribute="deemedDateReason">
																<reference attribute="evidence" />
															</reference>
															<Code table="BDMOASDeemedDateReason">
																<String value="DDR5" />
															</Code>
														</equals>
													</not>
												</members>
											</fixedlist>
										</all>
									</listitemexpression>
								</dynamiclist>
							</any>
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		<Attribute name="singleInstanceFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_SINGLE_INSTANCE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASDeemedDateValidationRuleSet" />
			</derivation>
		</Attribute>
		<Attribute name="deemedDateRecords">
			<type>
				<javaclass name="List">
					<ruleclass name="BDMOASDeemedDate"
						ruleset="BDMOASDeemedDateRuleSet" />
				</javaclass>
			</type>
			<derivation>
				<reference attribute="related_BDMOASDeemedDate">
					<reference attribute="applicationDetails">
						<reference attribute="evidence" />
					</reference>
				</reference>
			</derivation>
		</Attribute>
		<Attribute name="singleProtectiveDateValidation">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="singleProtectiveDateFailure" />
					<reference attribute="singleProtectiveDateFailureMessage" />
				</create>
			</derivation>
		</Attribute>
		<Attribute name="singleProtectiveDateFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="java.lang.Boolean" />
					</type>
					<when>
						<condition>
							<equals>
								<reference attribute="deemedDateReason">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMOASDeemedDateReason">
									<String value="DDR4" />
								</Code>
							</equals>
						</condition>
						<value>
							<any>
								<dynamiclist>
									<list>
										<reference attribute="deemedDateRecords"></reference>
									</list>
									<listitemexpression>
										<all>
											<fixedlist>
												<listof>
													<javaclass name="java.lang.Boolean" />
												</listof>
												<members>
													<not>
														<equals>
															<reference attribute="successionID">
																<current />
															</reference>
															<reference attribute="successionID">
																<reference attribute="evidence" />
															</reference>
														</equals>
													</not>
													<equals>
														<reference attribute="country">
															<current />
														</reference>
														<reference attribute="country">
															<reference attribute="evidence" />
														</reference>
													</equals>
												</members>
											</fixedlist>
										</all>
									</listitemexpression>
								</dynamiclist>
							</any>
						</value>
					</when>
					<otherwise>
						<value>
							<false />
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		<Attribute name="singleProtectiveDateFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_SINGLE_PROTECTIVE_DATE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASDeemedDateValidationRuleSet" />
			</derivation>
		</Attribute>
		<Attribute name="reasonLengthValidation">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="reasonLengthFailure" />
					<reference attribute="reasonLengthFailureMessage" />
				</create>
			</derivation>
		</Attribute>
		<Attribute name="reasonLengthFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="java.lang.Boolean" />
					</type>
					<when>
						<condition>
							<equals>
								<reference attribute="deemedDateReason">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMOASDeemedDateReason">
									<String value="DDR5" />
								</Code>
							</equals>
						</condition>
						<value>
							<compare comparison="&gt;">
								<Number value="3" />
								<property name="length">
									<object>
										<reference attribute="otherDeemedDateReason">
											<reference attribute="evidence" />
										</reference>
									</object>
								</property>
							</compare>
						</value>
					</when>
					<otherwise>
						<value>
							<false />
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		<Attribute name="reasonLengthFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_DEEMED_DATE_MIN_LENGTH"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASDeemedDateValidationRuleSet" />
			</derivation>
		</Attribute>
		<Attribute name="protectiveDateValidation">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="protectiveDateFailure" />
					<reference attribute="protectiveDateFailureMessage" />
				</create>
			</derivation>
		</Attribute>
		<Attribute name="protectiveDateFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="java.lang.Boolean" />
					</type>
					<when>
						<condition>
							<equals>
								<reference attribute="deemedDateReason">
									<reference attribute="evidence" />
								</reference>
								<Code table="BDMOASDeemedDateReason">
									<String value="DDR4" />
								</Code>
							</equals>
						</condition>
						<value>
							<not>
								<call class="curam.ca.gc.bdmoas.creole.impl.Statics"
									method="isProtectiveDateCountry">
									<type>
										<javaclass name="Boolean" />
									</type>
									<arguments>
										<reference attribute="country">
											<reference attribute="evidence" />
										</reference>
									</arguments>
								</call>
							</not>
						</value>
					</when>
					<otherwise>
						<value>
							<false />
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		<Attribute name="protectiveDateFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_PROTECTIVE_DATE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASDeemedDateValidationRuleSet" />
			</derivation>
		</Attribute>
	</Class>
</RuleSet>