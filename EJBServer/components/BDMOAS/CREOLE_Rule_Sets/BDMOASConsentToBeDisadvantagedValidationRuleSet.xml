<?xml version="1.0" encoding="UTF-8"?>
<RuleSet name="BDMOASConsentToBeDisadvantagedValidationRuleSet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="http://www.curamsoftware.com/CreoleRulesSchema.xsd">
	<Class extends="DefaultEvidenceValidationResult"
		extendsRuleSet="EvidenceValidationRuleSet" name="ValidationResult">

		<Attribute name="evidence">
			<type>
				<ruleclass name="BDMOASConsentToBeDisadvantaged"
					ruleset="BDMOASConsentToBeDisadvantagedRuleSet" />
			</type>
			<derivation>
				<specified />
			</derivation>
		</Attribute>
		<Attribute name="standardValidations">
			<type>
				<javaclass name="java.util.List">
					<ruleclass name="Validation"
						ruleset="EvidenceValidationRuleSet" />
				</javaclass>
			</type>
			<derivation>
				<fixedlist>
					<listof>
						<ruleclass name="Validation"
							ruleset="EvidenceValidationRuleSet" />
					</listof>
					<members>
						<reference
							attribute="consentStartDateAfterLivingApartStartDateValidator" />
						<reference
							attribute="consentStartDateBeforeLivingApartEndDateValidator" />
						<reference attribute="checkParticipantValidator"/>
					</members>
				</fixedlist>
			</derivation>
		</Attribute>

		<Attribute name="livingApartforReasonsBeyondControl">
			<type>
				<ruleclass name="BDMOASLivingApartforReasonsBeyondControl"
					ruleset="BDMOASLivingApartforReasonsBeyondControlRuleSet" />
			</type>
			<derivation>
				<reference attribute="livingApartforReasonsBeyondControl">
					<reference attribute="evidence" />
				</reference>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateAfterLivingApartStartDateValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="consentStartDateAfterLivingApartStartDateFailure" />
					<reference
						attribute="consentStartDateAfterLivingApartStartDateFailureMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateAfterLivingApartStartDateFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<not>
					<compare comparison="&gt;=">
						<reference attribute="startDate">
							<reference attribute="evidence" />
						</reference>
						<reference attribute="startDate">
							<reference
								attribute="livingApartforReasonsBeyondControl">
								<reference attribute="evidence" />
							</reference>
						</reference>
					</compare>
				</not>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateAfterLivingApartStartDateFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_CONSENT_START_DATE_BEFORE_LIVING_APART_START_DATE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASConsentToBeDisadvantagedValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateBeforeLivingApartEndDateValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="consentStartDateBeforeLivingApartEndDateFailure" />
					<reference
						attribute="consentStartDateBeforeLivingApartEndDateFailureMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateBeforeLivingApartEndDateFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="java.lang.Boolean" />
						</listof>
						<members>
							<not>
								<equals>
									<reference attribute="endDate">
										<reference
											attribute="livingApartforReasonsBeyondControl">
											<reference attribute="evidence" />
										</reference>
									</reference>
									<null />
								</equals>
							</not>
							<not>
								<compare comparison="&lt;">
									<reference attribute="startDate">
										<reference attribute="evidence" />
									</reference>
									<reference attribute="endDate">
										<reference
											attribute="livingApartforReasonsBeyondControl">
											<reference attribute="evidence" />
										</reference>
									</reference>
								</compare>
							</not>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>

		<Attribute
			name="consentStartDateBeforeLivingApartEndDateFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_CONSENT_START_DATE_AFTER_LIVING_APART_END_DATE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASConsentToBeDisadvantagedValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>
		
		<Attribute
			name="checkParticipantValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="checkParticipantFailure" />
					<reference
						attribute="checkParticipantFailureMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute
			name="checkParticipantFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<all>
					<fixedlist>
						<listof>
							<javaclass name="java.lang.Boolean" />
						</listof>
						<members>
							<not>
								<equals>
									<reference attribute="caseParticipantRole">
										<reference attribute="evidence" />
									</reference>
									<reference attribute="caseParticipantRoleID">
										<reference attribute="maritalRelationship">
											<reference
												attribute="livingApartforReasonsBeyondControl">
												<reference attribute="evidence" />
											</reference>
										</reference>
									</reference>
								</equals>
							</not>
							<not>
								<equals>
									<reference attribute="caseParticipantRole">
										<reference attribute="evidence" />
									</reference>
									<reference attribute="relatedCaseParticipantRoleID">
										<reference attribute="maritalRelationship">
											<reference
												attribute="livingApartforReasonsBeyondControl">
												<reference attribute="evidence" />
											</reference>
										</reference>
									</reference>
								</equals>
							</not>
						</members>
					</fixedlist>
				</all>
			</derivation>
		</Attribute>

		<Attribute
			name="checkParticipantFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_PARTICIPANT_NOT_PART_OF_MARITAL_RELATIONSHIP"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASConsentToBeDisadvantagedValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

	</Class>
</RuleSet>