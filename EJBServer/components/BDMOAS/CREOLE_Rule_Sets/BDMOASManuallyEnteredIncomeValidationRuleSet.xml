<?xml version="1.0" encoding="UTF-8"?>
<!-- TASK 74615 DEV: Implement Manually Entered Income -->

<RuleSet name="BDMOASManuallyEnteredIncomeValidationRuleSet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="../../../build/svr/creole.gen/schema/RuleSet.xsd">

	<Class extends="DefaultEvidenceValidationResult"
		extendsRuleSet="EvidenceValidationRuleSet" name="ValidationResult">

		<Attribute name="description">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="Description"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet" />
			</derivation>
		</Attribute>

		<Attribute name="evidence">
			<type>
				<ruleclass name="BDMOASManuallyEnteredIncome"
					ruleset="BDMOASManuallyEnteredIncomeRuleSet" />
			</type>
			<derivation>
				<specified />
			</derivation>
		</Attribute>
		<Attribute name="standardValidations">
			<type>
				<javaclass name="java.util.List">
					<ruleclass name="Validation"
						ruleset="EvidenceValidationRuleSet" />
				</javaclass>
			</type>
			<derivation>
				<fixedlist>
					<listof>
						<ruleclass name="Validation"
							ruleset="EvidenceValidationRuleSet" />
					</listof>
					<members>
						
						<reference attribute="yearWholeNumberValidator" />
						<reference
							attribute="canadaPensionPlanOrQuebecPensionAmountValidator" />
						<reference
							attribute="otherCanadianPensionIncomeAmountValidator" />
						<reference
							attribute="foreignPensionIncomeAmountValidator" />
						<reference
							attribute="employmentInsuranceAmountValidator" />
						<reference
							attribute="workersCompensationBenefitAmountValidator" />
						<reference
							attribute="interestAndOtherInvestmentIncomeAmountValidator" />
						<reference
							attribute="eligibleAndOtherThanEligibleDividendsAmountValidator" />
						<reference attribute="capitalGainsAmountValidator" />
						<reference
							attribute="netEmploymentIncomeAmountValidator" />
						<reference
							attribute="incomeYearOnOrAfterBirthYearValidator" />
						<reference
							attribute="incomeYearOnOrBeforeDeathYearValidator" />
					</members>
				</fixedlist>
			</derivation>
		</Attribute>

		<Attribute name="yearWholeNumberValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="yearWholeNumberFailure" />
					<reference attribute="yearWholeNumberFailureMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute name="caseID">
			<type>
				<javaclass name="Number" />
			</type>
			<derivation>
				<reference attribute="caseID">
					<reference attribute="evidence" />
				</reference>
			</derivation>
		</Attribute>

		<Attribute name="concernRoleRecord">
			<type>
				<ruleclass name="ConcernRole"
					ruleset="ParticipantEntitiesRuleSet" />
			</type>
			<derivation>
				<singleitem onEmpty="error" onMultiple="error">
					<readall ruleclass="ConcernRole"
						ruleset="ParticipantEntitiesRuleSet">
						<match retrievedattribute="concernRoleID">
							<reference attribute="participantRoleID">
								<reference attribute="related_caseParticipantRole">
									<reference attribute="evidence" />
								</reference>
							</reference>
						</match>
					</readall>
				</singleitem>
			</derivation>
		</Attribute>

		<Attribute name="yearWholeNumberFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<not>
					<call class="curam.ca.gc.bdm.creole.impl.Statics"
						method="isValidYear">
						<type>
							<javaclass name="Boolean" />
						</type>
						<arguments>
							<reference attribute="year">
								<reference attribute="evidence" />
							</reference>
						</arguments>
					</call>
				</not>
			</derivation>
		</Attribute>

		<Attribute name="yearWholeNumberFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_YEAR_MUST_BE_IN_RANGE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
					<call class="curam.ca.gc.bdm.creole.impl.Statics"
						method="getPreviousYear">
						<type>
							<javaclass name="String" />
						</type>
						<arguments />
					</call>
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute
			name="canadaPensionPlanOrQuebecPensionAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="canadaPensionPlanOrQuebecPensionAmountValidatorFailure" />
					<reference
						attribute="canadaPensionPlanOrQuebecPensionAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>

		<Attribute
			name="canadaPensionPlanOrQuebecPensionAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference
						attribute="canadaPensionPlanOrQuebecPensionBenefit">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute
			name="canadaPensionPlanOrQuebecPensionAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_CANADIAN_PENSION_PLAN_OR_QUEBEC_PENSION_AMOUNT_NEGETIVE"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute name="otherCanadianPensionIncomeAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="otherCanadianPensionIncomeAmountValidatorFailure" />
					<reference
						attribute="otherCanadianPensionIncomeAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute
			name="otherCanadianPensionIncomeAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="otherCanadianPensionIncome">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute
			name="otherCanadianPensionIncomeAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_OTHER_CANADIAN_PENSION_INCOME_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute name="foreignPensionIncomeAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="foreignPensionIncomeAmountValidatorFailure" />
					<reference
						attribute="foreignPensionIncomeAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute name="foreignPensionIncomeAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="foreignPensionIncome">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute name="foreignPensionIncomeAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_FOREIGN_PENSION_INCOME_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute name="employmentInsuranceAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="employmentInsuranceAmountValidatorFailure" />
					<reference
						attribute="employmentInsuranceAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute name="employmentInsuranceAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="employmentInsurance">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute name="employmentInsuranceAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_EMPLOYMENT_INSURANCE_INCOME_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute name="workersCompensationBenefitAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="workersCompensationBenefitAmountValidatorFailure" />
					<reference
						attribute="workersCompensationBenefitAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute
			name="workersCompensationBenefitAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="workersCompensationBenefits">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute
			name="workersCompensationBenefitAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_WORKERS_COMPENSATION_BENEFIT_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute
			name="interestAndOtherInvestmentIncomeAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="interestAndOtherInvestmentIncomeAmountValidatorFailure" />
					<reference
						attribute="interestAndOtherInvestmentIncomeAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute
			name="interestAndOtherInvestmentIncomeAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="interestAndOtherInvestmentIncome">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute
			name="interestAndOtherInvestmentIncomeAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_INTEREST_AND_OTHER_INVESTMENT_INCOME_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute
			name="eligibleAndOtherThanEligibleDividendsAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="eligibleAndOtherThanEligibleDividendsAmountValidatorFailure" />
					<reference
						attribute="eligibleAndOtherThanEligibleDividendsAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute
			name="eligibleAndOtherThanEligibleDividendsAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference
						attribute="eligibleAndOtherThanEligibleDividends">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute
			name="eligibleAndOtherThanEligibleDividendsAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_ELIGIBILE_AND_OTHER_THAN_ELIGIBLE_DEVIDENDS_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>


		<Attribute name="capitalGainsAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference attribute="capitalGainsAmountValidatorFailure" />
					<reference attribute="capitalGainsAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute name="capitalGainsAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="capitalGains">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute name="capitalGainsAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage key="ERR_CAPITAL_GAINS_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

		<Attribute name="netEmploymentIncomeAmountValidator">
			<type>
				<ruleclass name="Validation"
					ruleset="EvidenceValidationRuleSet" />
			</type>
			<derivation>
				<create ruleclass="Validation"
					ruleset="EvidenceValidationRuleSet">
					<reference
						attribute="netEmploymentIncomeAmountValidatorFailure" />
					<reference
						attribute="netEmploymentIncomeAmountFailureMessage" />
				</create>
			</derivation>
		</Attribute>


		<Attribute name="netEmploymentIncomeAmountValidatorFailure">
			<type>
				<javaclass name="java.lang.Boolean" />
			</type>
			<derivation>
				<compare comparison="&lt;">
					<reference attribute="netEmploymentIncome">
						<reference attribute="evidence" />
					</reference>
					<Number value="0.00" />
				</compare>
			</derivation>
		</Attribute>

		<Attribute name="netEmploymentIncomeAmountFailureMessage">
			<type>
				<javaclass name="curam.creole.value.Message" />
			</type>
			<derivation>
				<ResourceMessage
					key="ERR_NET_EMPLOYMENT_INCOME_AMOUNT"
					resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
				</ResourceMessage>
			</derivation>
		</Attribute>

        <Attribute name="incomeYearOnOrAfterBirthYearValidator">
            <type>
                <ruleclass name="Validation"
                    ruleset="EvidenceValidationRuleSet" />
            </type>
            <derivation>
                <create ruleclass="Validation"
                    ruleset="EvidenceValidationRuleSet">
                    <reference
                        attribute="incomeYearOnOrAfterBirthYearValidatorFailure" />
                    <reference
                        attribute="incomeYearOnOrAfterBirthYearValidatorMessage" />
                </create>
            </derivation>
        </Attribute>

        <Attribute name="incomeYearOnOrAfterBirthYearValidatorFailure">
            <type>
                <javaclass name="java.lang.Boolean" />
            </type>
            <derivation>
                <compare comparison="&lt;">
                    <reference attribute="year">
                        <reference attribute="evidence" />
                    </reference>
                    <reference attribute="birthYear" />
                </compare>
            </derivation>
        </Attribute>

        <Attribute name="incomeYearOnOrAfterBirthYearValidatorMessage">
            <type>
                <javaclass name="curam.creole.value.Message" />
            </type>
            <derivation>
                <ResourceMessage
                    key="ERR_YEAR_BEFORE_BIRTH_YEAR"
                    resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
                </ResourceMessage>
            </derivation>
        </Attribute>

        <Attribute name="incomeYearOnOrBeforeDeathYearValidator">
            <type>
                <ruleclass name="Validation"
                    ruleset="EvidenceValidationRuleSet" />
            </type>
            <derivation>
                <create ruleclass="Validation"
                    ruleset="EvidenceValidationRuleSet">
                    <reference
                        attribute="incomeYearOnOrBeforeDeathYearValidatorFailure" />
                    <reference
                        attribute="incomeYearOnOrBeforeDeathYearValidatorMessage" />
                </create>
            </derivation>
        </Attribute>

        <Attribute name="incomeYearOnOrBeforeDeathYearValidatorFailure">
            <type>
                <javaclass name="java.lang.Boolean" />
            </type>
            <derivation>
                <all>
                    <fixedlist>
                        <listof>
                            <javaclass name="java.lang.Boolean" />
                        </listof>
                        <members>
                            <reference attribute="dateOfDeathExists" />
                            <compare comparison="&gt;">
                                <reference attribute="year">
                                    <reference attribute="evidence" />
                                </reference>
                                <reference attribute="deathYear" />
                            </compare>
                        </members>
                    </fixedlist>
                </all>
            </derivation>
        </Attribute>

        <Attribute name="incomeYearOnOrBeforeDeathYearValidatorMessage">
            <type>
                <javaclass name="curam.creole.value.Message" />
            </type>
            <derivation>
                <ResourceMessage
                    key="ERR_YEAR_AFTER_DEATH_YEAR"
                    resourceBundle="curam.ca.gc.bdmoas.evidence.BDMOASManuallyEnteredIncomeValidationRuleSet">
                </ResourceMessage>
            </derivation>
        </Attribute>
        
        <Attribute name="participantDataCaseHeader">
            <type>
                <ruleclass name="CaseHeader"
                    ruleset="CaseEntitiesRuleSet" />
            </type>
            <derivation>
                <singleitem onMultiple="returnFirst"
                    onEmpty="error">
                    <filter>
                        <list>
                            <readall ruleclass="CaseHeader"
                                ruleset="CaseEntitiesRuleSet">
                                <match
                                    retrievedattribute="concernRoleID">
                                    <reference attribute="participantRoleID">
                                        <reference attribute="related_caseParticipantRole">
                                            <reference attribute="evidence" />
                                        </reference>
                                    </reference>
                                </match>
                            </readall>
                        </list>
                        <listitemexpression>
                            <equals>
                                <reference
                                    attribute="caseTypeCode">
                                    <current />
                                </reference>
                                <Code table="CaseTypeCode">
                                    <String value="CT2001" />
                                </Code>
                            </equals>
                        </listitemexpression>
                    </filter>
                </singleitem>
            </derivation>
        </Attribute>

        <Attribute name="birthAndDeathEvidence">
            <type>
                <ruleclass name="PDCBirthAndDeath"
                    ruleset="PDCBirthAndDeathDataRuleSet" />
            </type>
            <derivation>
                <singleitem onMultiple="returnFirst"
                    onEmpty="error">
                    <readall ruleclass="PDCBirthAndDeath"
                        ruleset="PDCBirthAndDeathDataRuleSet">
                        <match retrievedattribute="caseID">
                            <reference attribute="caseID">
                                <reference
                                    attribute="participantDataCaseHeader" />
                            </reference>
                        </match>
                    </readall>
                </singleitem>
            </derivation>
        </Attribute>

        <Attribute name="dateOfDeathExists">
            <type>
                <javaclass name="java.lang.Boolean"/>
            </type>
            <derivation>
                <choose>
                    <type>
                        <javaclass name="java.lang.Boolean" />
                    </type>
                    <when>
                        <condition>
                            <not>
                                <equals>
                                    <null />
                                    <reference attribute="dateOfDeath">
                                        <reference attribute="birthAndDeathEvidence" />
                                    </reference>
                                </equals>
                            </not>
                        </condition>
                        <value>
                            <true />
                        </value>
                    </when>
                    <otherwise>
                        <value>
                            <false />
                        </value>
                    </otherwise>
                </choose>
            </derivation>
        </Attribute>
        
        <Attribute name="birthYear">
            <type>
                <javaclass name="String"></javaclass>
            </type>
            <derivation>
                <call class="curam.ca.gc.bdm.creole.impl.Statics" method="getYearFromDate">
                    <type>
                        <javaclass name="String" />
                    </type>
                    <arguments>
                        <reference attribute="dateOfBirth">
                            <reference attribute="birthAndDeathEvidence" />
                        </reference>
                    </arguments>
                </call>
            </derivation>
        </Attribute>
        
        <Attribute name="deathYear">
            <type>
                <javaclass name="String"></javaclass>
            </type>
            <derivation>
                <call class="curam.ca.gc.bdm.creole.impl.Statics" method="getYearFromDate">
                    <type>
                        <javaclass name="String" />
                    </type>
                    <arguments>
                        <reference attribute="dateOfDeath">
                            <reference attribute="birthAndDeathEvidence" />
                        </reference>
                    </arguments>
                </call>
            </derivation>
        </Attribute>
	</Class>
</RuleSet>