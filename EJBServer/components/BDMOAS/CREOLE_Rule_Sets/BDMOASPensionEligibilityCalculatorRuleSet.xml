<RuleSet name="BDMOASPensionEligibilityCalculatorRuleSet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="http://www.curamsoftware.com/CreoleRulesSchema.xsd">
	<Class name="BDMOASPensionEligibilityCalculator"
		extends="BDMOASAbstractEligibilityCalculator"
		extendsRuleSet="BDMOASEligibilityCalculatorRuleSet">
		<Attribute name="benefitType">
			<type>
				<codetableentry table="BDMOASBenefitType" />
			</type>
			<derivation>
				<Code table="BDMOASBenefitType">
					<String value="BT1" />
				</Code>
			</derivation>
		</Attribute>
		<Attribute name="minimumAge">
			<type>
				<javaclass name="Number" />
			</type>
			<derivation>
				<Number value="65" />
			</derivation>
		</Attribute>
		<Attribute name="residenceCalculator">
			<type>
				<ruleclass name="BDMOASResidenceCalculator"
					ruleset="BDMOASResidenceCalculatorRuleSet" />
			</type>
			<derivation>
				<create ruleclass="BDMOASResidenceCalculator"
					ruleset="BDMOASResidenceCalculatorRuleSet">
					<reference attribute="caseParticipantRoleID" />
				</create>
			</derivation>
		</Attribute>
		<Attribute name="isEligibleTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<timelineoperation>
					<all>
						<fixedlist>
							<listof>
								<javaclass name="Boolean" />
							</listof>
							<members>
								<intervalvalue>
									<reference attribute="rawIsEligibleTimeline" />
								</intervalvalue>
								<intervalvalue>
									<reference attribute="isPotentiallyEffectiveTimeline" />
								</intervalvalue>
							</members>
						</fixedlist>
					</all>
				</timelineoperation>
			</derivation>
		</Attribute>
		<Attribute name="rawIsEligibleTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<timelineoperation>
					<all>
						<fixedlist>
							<listof>
								<javaclass name="Boolean" />
							</listof>
							<members>
								<intervalvalue>
									<reference attribute="isAliveDuringMonthTimeline">
										<reference attribute="participantCalculator" />
									</reference>
								</intervalvalue>
								<intervalvalue>
									<reference attribute="isApplicantTimeline">
										<reference attribute="applicationCalculator" />
									</reference>
								</intervalvalue>
								<intervalvalue>
									<reference attribute="meetsAgeRequirementTimeline" />
								</intervalvalue>
								<intervalvalue>
									<reference
										attribute="legalStatusResidenceApprovalTimeline" />
								</intervalvalue>
							</members>
						</fixedlist>
					</all>
				</timelineoperation>
			</derivation>
		</Attribute>
		<Attribute name="effectiveDate">
			<type>
				<javaclass name="curam.util.type.Date" />
			</type>
			<derivation>
				<call class="curam.ca.gc.bdm.creole.impl.Statics"
					method="getEarliestTrueDate">
					<type>
						<javaclass name="curam.util.type.Date" />
					</type>
					<arguments>
						<reference attribute="isEligibleTimeline" />
					</arguments>
				</call>
			</derivation>
		</Attribute>
		<Attribute name="earliestPotentialEffectiveDate">
			<type>
				<javaclass name="curam.util.type.Date" />
			</type>
			<derivation>
				<call class="curam.ca.gc.bdm.creole.impl.Statics"
					method="getSubsequentMonthStart">
					<type>
						<javaclass name="curam.util.type.Date" />
					</type>
					<arguments>
						<call class="curam.ca.gc.bdm.creole.impl.Statics"
							method="getEarliestTrueDate">
							<type>
								<javaclass name="curam.util.type.Date" />
							</type>
							<arguments>
								<timelineoperation>
									<all>
										<fixedlist>
											<listof>
												<javaclass name="Boolean" />
											</listof>
											<members>
												<intervalvalue>
													<reference
														attribute="meetsResidenceRequirementTimeline" />
												</intervalvalue>
												<intervalvalue>
													<reference
														attribute="meetsAgeRequirementTimeline" />
												</intervalvalue>
											</members>
										</fixedlist>
									</all>
								</timelineoperation>
							</arguments>
						</call>
					</arguments>
				</call>
			</derivation>
		</Attribute>
		<Attribute name="isPotentiallyEffectiveTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<existencetimeline>
					<intervaltype>
						<javaclass name="Boolean" />
					</intervaltype>
					<intervalfromdate>
						<call class="curam.ca.gc.bdm.creole.impl.Statics"
							method="getSubsequentMonthStart">
							<type>
								<javaclass name="curam.util.type.Date" />
							</type>
							<arguments>
								<call class="curam.ca.gc.bdm.creole.impl.Statics"
									method="getEarliestTrueDate">
									<type>
										<javaclass name="curam.util.type.Date" />
									</type>
									<arguments>
										<reference attribute="rawIsEligibleTimeline" />
									</arguments>
								</call>
							</arguments>
						</call>
					</intervalfromdate>
					<intervaltodate>
						<null />
					</intervaltodate>
					<preExistenceValue>
						<false />
					</preExistenceValue>
					<existenceValue>
						<true />
					</existenceValue>
					<postExistenceValue>
						<false />
					</postExistenceValue>
				</existencetimeline>
			</derivation>
		</Attribute>
		<Attribute name="meetsLegalStatusAndResidenceDate">
			<type>
				<javaclass name="curam.util.type.Date" />
			</type>
			<derivation>
				<call class="curam.ca.gc.bdm.creole.impl.Statics"
					method="getEarliestTrueDate">
					<type>
						<javaclass name="curam.util.type.Date" />
					</type>
					<arguments>
						<timelineoperation>
							<all>
								<fixedlist>
									<listof>
										<javaclass name="Boolean" />
									</listof>
									<members>
										<intervalvalue>
											<reference
												attribute="meetsLegalStatusRequirementTimeline" />
										</intervalvalue>
										<intervalvalue>
											<reference
												attribute="meetsResidenceRequirementTimeline" />
										</intervalvalue>
									</members>
								</fixedlist>
							</all>
						</timelineoperation>
					</arguments>
				</call>
			</derivation>
		</Attribute>
		<Attribute name="legalStatusResidenceApprovalTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<existencetimeline>
					<intervaltype>
						<javaclass name="Boolean" />
					</intervaltype>
					<intervalfromdate>
						<reference attribute="meetsLegalStatusAndResidenceDate" />
					</intervalfromdate>
					<intervaltodate>
						<null />
					</intervaltodate>
					<preExistenceValue>
						<false />
					</preExistenceValue>
					<existenceValue>
						<not>
							<equals>
								<Date value="0001-01-01" />
								<reference
									attribute="meetsLegalStatusAndResidenceDate" />
							</equals>
						</not>
					</existenceValue>
					<postExistenceValue>
						<false />
					</postExistenceValue>
				</existencetimeline>
			</derivation>
		</Attribute>
		<Attribute name="initialIsEligibleTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<timelineoperation>
					<all>
						<fixedlist>
							<listof>
								<javaclass name="Boolean" />
							</listof>
							<members>
								<intervalvalue>
									<reference attribute="determinationTimeline">
										<create ruleclass="BDMOASDeterminationContext"
											ruleset="BDMOASEligibilityEntitlementRuleSet">
											<reference attribute="caseID">
												<reference attribute="caseData">
													<reference attribute="caseParticipantData">
														<reference attribute="participantCalculator" />
													</reference>
												</reference>
											</reference>
										</create>
									</reference>
								</intervalvalue>
								<all>
									<fixedlist>
										<listof>
											<javaclass name="Boolean" />
										</listof>
										<members>
											<intervalvalue>
												<reference attribute="isApplicantTimeline">
													<reference attribute="applicationCalculator" />
												</reference>
											</intervalvalue>
											<intervalvalue>
												<reference attribute="meetsAgeRequirementTimeline" />
											</intervalvalue>
											<intervalvalue>
												<reference
													attribute="meetsLegalStatusRequirementTimeline" />
											</intervalvalue>
										</members>
									</fixedlist>
								</all>
							</members>
						</fixedlist>
					</all>
				</timelineoperation>
			</derivation>
		</Attribute>
		<Attribute name="isResidenceHistoryComplete">
			<type>
				<javaclass name="Boolean" />
			</type>
			<derivation>
				<equals>
					<timelineoperation>
						<all>
							<fixedlist>
								<listof>
									<javaclass name="Boolean" />
								</listof>
								<members>
									<intervalvalue>
										<reference attribute="isResidenceRequiredTimeline" />
									</intervalvalue>
									<intervalvalue>
										<reference
											attribute="residenceHistoryExistsTimeline">
											<reference attribute="residenceCalculator" />
										</reference>
									</intervalvalue>
								</members>
							</fixedlist>
						</all>
					</timelineoperation>
					<reference attribute="isResidenceRequiredTimeline" />
				</equals>
			</derivation>
		</Attribute>
		<Attribute name="isResidenceRequiredTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<existencetimeline>
					<intervaltype>
						<javaclass name="Boolean" />
					</intervaltype>
					<intervalfromdate>
						<call class="curam.ca.gc.bdm.creole.impl.Statics"
							method="addYearsToDate">
							<type>
								<javaclass name="curam.util.type.Date" />
							</type>
							<arguments>
								<reference attribute="dateOfBirth">
									<reference attribute="participantCalculator" />
								</reference>
								<Number value="18" />
							</arguments>
						</call>
					</intervalfromdate>
					<intervaltodate>
						<call class="curam.ca.gc.bdm.creole.impl.Statics"
							method="getEarliestTrueDate">
							<type>
								<javaclass name="curam.util.type.Date" />
							</type>
							<arguments>
								<reference attribute="initialIsEligibleTimeline" />
							</arguments>
						</call>
					</intervaltodate>
					<preExistenceValue>
						<false />
					</preExistenceValue>
					<existenceValue>
						<true />
					</existenceValue>
					<postExistenceValue>
						<false />
					</postExistenceValue>
				</existencetimeline>
			</derivation>
		</Attribute>
		<Attribute name="meetsResidenceRequirementTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Boolean" />
				</javaclass>
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="curam.creole.value.Timeline">
							<javaclass name="Boolean" />
						</javaclass>
					</type>
					<when>
						<condition>
							<reference attribute="isResidenceHistoryComplete" />
						</condition>
						<value>
							<timelineoperation>
								<compare comparison="&gt;=">
									<intervalvalue>
										<reference
											attribute="aggregateResidenceYearTimeline" />
									</intervalvalue>
									<reference attribute="minimumResidenceYears" />
								</compare>
							</timelineoperation>
						</value>
					</when>
					<otherwise>
						<value>
							<timelineoperation>
								<false />
							</timelineoperation>
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
		<Attribute name="aggregateResidenceYearTimeline">
			<type>
				<javaclass name="curam.creole.value.Timeline">
					<javaclass name="Number" />
				</javaclass>
			</type>
			<derivation>
				<call class="curam.ca.gc.bdmoas.creole.impl.Statics"
					method="getAggregateResidenceTimeline">
					<type>
						<javaclass name="curam.creole.value.Timeline">
							<javaclass name="Number" />
						</javaclass>
					</type>
					<arguments>
						<reference attribute="canadianEligiblePeriodList">
							<reference attribute="residenceCalculator" />
						</reference>
						<null />
					</arguments>
				</call>
			</derivation>
		</Attribute>
		<Attribute name="minimumResidenceYears">
			<type>
				<javaclass name="Number" />
			</type>
			<derivation>
				<choose>
					<type>
						<javaclass name="Number" />
					</type>
					<when>
						<condition>
							<reference attribute="isApplyingWithinCanada" />
						</condition>
						<value>
							<Number value="10" />
						</value>
					</when>
					<otherwise>
						<value>
							<Number value="20" />
						</value>
					</otherwise>
				</choose>
			</derivation>
		</Attribute>
	</Class>
</RuleSet>