<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:curam="http://www.curamsoftware.com/curam" xmlns:cing="http://www.curamsoftware.com/curam/jde/client/curam-ng" xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"> <jsp:directive.page isErrorPage="false" pageEncoding="UTF-8" contentType="text/html;charset=UTF-8" isELIgnored="false" language="java" buffer="32kb"/> <jsp:directive.page import="curam.omega3.user.InfrastructureUserPreferences"/> <jsp:directive.page import="curam.omega3.user.UserPreferencesFactory"/> <jsp:directive.page import="curam.omega3.user.UserPreferences"/> <jsp:directive.page import="curam.omega3.util.CDEJResources"/> <jsp:directive.page import="curam.util.client.jsp.JspUtil"/> <jsp:directive.page import="curam.util.common.util.xml.XMLEscaper"/> <jsp:directive.page import="curam.util.common.util.JavaScriptEscaper"/> <jsp:output omit-xml-declaration="yes"/> <jsp:text> <![CDATA[<!DOCTYPE html>]]> </jsp:text> <jsp:scriptlet> pageContext.setAttribute("landmarkLabel", curam.omega3.util.CDEJResources .getProperty("modal.panel.frame.title")); UserPreferences prefs = UserPreferencesFactory .getUserPreferences(session); pageContext .setAttribute("pageLocale", prefs.getLocale().toString()); pageContext.setAttribute("dojoConfig", JspUtil.getDojoConfig(prefs.getLocale())); pageContext.setAttribute("testModeEnabled", curam.omega3.util.DataTestIDUtils.isTestModeEnabled()); String ctx = request .getParameter(curam.omega3.taglib.ScreenContext.CTX_PARAM); curam.omega3.taglib.ScreenContext sc = new curam.omega3.taglib.ScreenContext(); sc.set(ctx); sc.clearStates(); pageContext.setAttribute("currentContext", sc.getValue()); try { pageContext .setAttribute( "highContrastMode", prefs.getUserPreference(InfrastructureUserPreferences.HIGH_CONTRAST_MODE)); } catch (final curam.util.common.JDEException e) { pageContext.setAttribute("highContrastMode", "false"); } pageContext.setAttribute("o3__serverURL", JspUtil.getServerRootURL(1)); </jsp:scriptlet> <curam:userPreferences localeCode="${pageScope.pageLocale}"/> <c:set scope="request" value="modal-message-dialog" var="pageId"/> <curam:removeMessages/> <jsp:scriptlet> if (pageContext.getAttribute("htmlDirection").equals("rtl")) { pageContext.setAttribute("classDirection", "rtl"); } else { pageContext.setAttribute("classDirection", ""); } </jsp:scriptlet> <html lang="${pageLocale}" dir="${htmlDirection}" class="${classDirection}" role="region" aria-label="${safeLandmarkLabel}"> <jsp:scriptlet> <![CDATA[ pageContext.setAttribute("theme", "v6",pageContext.APPLICATION_SCOPE); ]]> </jsp:scriptlet> <head>
<meta content="text/html;charset=UTF-8" http-equiv="Content-Type"/>
<link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/jscript/dojotk/dojo/resources/dojo.css" media="all"/>
<link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/jscript/dojotk/dijit/themes/dijit.css" media="all"/> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/jscript/ibmidxtk/idx/themes/oneui/oneui-curam-custom.css" media="all"/> <jsp:scriptlet> <![CDATA[ String ccsBodyCuramInternal=""; if (sc.hasContextBits(curam.omega3.taglib.ScreenContext.EXTAPP)) { pageContext.setAttribute("ccsBodyCuramInternal", ""); }else{ pageContext.setAttribute("ccsBodyCuramInternal", "curam"); } ]]>
</jsp:scriptlet> <jsp:scriptlet> if ("true".equals(pageContext.getAttribute("highContrastMode"))) { pageContext.setAttribute("highContrastClassName","high-contrast"); }
</jsp:scriptlet> <c:choose> <c:when test="${pageScope.ccsBodyCuramInternal == 'curam'}"> <link href="${pageScope.o3__serverURL}themes/${applicationScope.theme}/css/${applicationScope.theme}_main.css" media="all" type="text/css" rel="stylesheet"/> <link href="${pageScope.o3__serverURL}themes/curam/css/curam_main.css" media="all" type="text/css" rel="stylesheet"/> <c:if test="${pageScope.htmlDirection == 'rtl'}"> <link rel="stylesheet" href="${pageScope.o3__serverURL}themes/curam_rtl/css/curam_rtl_main.css" media="all" type="text/css"/> </c:if> </c:when> <c:otherwise> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/extapp/themes/curam-extapp/curam-extapp.css" media="all"/> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/extapp/uim.css"/> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/extapp/high-contrast.css"/> <c:if test="${pageScope.htmlDirection == 'rtl'}"> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/extapp/themes/curam-extapp/curam-extapp_rtl.css" media="all"/> <link type="text/css" rel="stylesheet" href="${pageScope.o3__serverURL}CDEJ/extapp/uim_rtl.css"/> </c:if> </c:otherwise>
</c:choose> <jsp:text> <![CDATA[<!--[if IE]>]]>
</jsp:text> <link href="${pageScope.o3__serverURL}themes/${applicationScope.theme}/css/${applicationScope.theme}_cc_IE.css" media="all" type="text/css" rel="stylesheet"/> <jsp:text><![CDATA[<![endif]-->]]> </jsp:text> <jsp:text><![CDATA[<!--[if IE 9]>]]></jsp:text> <link href="${pageScope.o3__serverURL}themes/${applicationScope.theme}/css/${applicationScope.theme}_cc_IE9.css" media="all" type="text/css" rel="stylesheet"/> <jsp:text><![CDATA[<![endif]-->]]></jsp:text> <link href="${pageScope.o3__serverURL}CDEJ/css/custom.css" media="all" type="text/css" rel="stylesheet"/> <jsp:text> <![CDATA[<!--[if IE]>]]> </jsp:text> <link href="${pageScope.o3__serverURL}CDEJ/css/custom_cc_ie" media="all" type="text/css" rel="stylesheet"/> <jsp:text><![CDATA[<![endif]-->]]> </jsp:text> <link href="${pageScope.o3__serverURL}themes/classic/images/icons/curam.ico" rel="shortcut icon"/>
<link href="${pageScope.o3__serverURL}themes/classic/images/icons/curam.ico" rel="icon"/> <script type="text/javascript">
	<jsp:scriptlet>JspUtil.outputDojoLoaderConfiguration(pageContext, prefs.getLocale());</jsp:scriptlet>
</script>
<script type="text/javascript" src="${pageScope.o3__serverURL}CDEJ/jscript/dojotk/dojo/dojo.js">// dummy script content</script>
<script type="text/javascript">
	<jsp:scriptlet>JspUtil.outputJSModulePaths(pageContext);
	</jsp:scriptlet>
	<jsp:text><![CDATA[
	require([ "curam/core-uim" ]);
	var sessTimeout;
	var alreadySubmitted = 0;
	var treeEnabled = true;
	var doubleLists = new Array();
	var jsPageID = "modal-message-dialog";
	]]></jsp:text>
</script>
<script src="${pageScope.o3__serverURL}CDEJ/jscript/cdej.js" type="text/javascript">// script content</script>
<script src="${pageScope.o3__serverURL}CDEJ/jscript/cdej-cm.js"	type="text/javascript">	// script content</script>
<jsp:scriptlet>JspUtil.outputJSLocalisedValues(pageContext);</jsp:scriptlet>
<script type="text/javascript">
	<jsp:text><![CDATA[
	require(
			[ "dojo/_base/unload", "curam/util", "curam/util/onLoad", "curam/util/ScreenContext",
					"curam/dialog" ],
			function(baseUnload) {
				dojo.global.jsBaseURL = curam.util.retrieveBaseURL();
				dojo.global.jsScreenContext = new curam.util.ScreenContext();
				dojo.global.jsScreenContext.setContext('MODAL');
				// register publisher for the pageID and title information
				curam.util.onLoad.addPublisher(function(context) {
					context.pageID = jsPageID;
				});

				// register publisher for the page height and title information
				curam.util.onLoad
						.addPublisher(function(context) {
							context.height = sessTimeout
									.getTimeoutWarningConfig().height;
							context.title = sessTimeout
										.getTimeoutWarningConfig().titleTxt;
							

						});
				curam.dialog.forceParentRefresh();
				curam.dialog.initModal('modal-message-dialog');
				
		        baseUnload.addOnUnload(function() {
		        	var topWin = curam.util.getTopmostWindow();
		        	topWin.dojo.publish("curam/modal/close/ignoreRefresh");
		        });
			});
	]]></jsp:text>
	
    function setFocusOnMessage() {
      document.getElementById('userMessage').focus();
      return true;
    }
    
    function confirmTimeout() {
     var topWin = curam.util.getTopmostWindow(); 
   	  topWin.curam.util.SessionTimeout.waitForRedirection();
      curam.dialog.closeModalDialog();
    }
    
    function confirmStay() {
      var topWin = curam.util.getTopmostWindow();
      topWin.curam.util.SessionTimeout.resetAndStay();
      curam.dialog.closeModalDialog();
    }
    
    function useLocalButton(btnName, btnText) {
      var actionsPanel = document.querySelector("#actions-panel");
      var buttonId = '__o3btn.' + btnName;
      var replBtn = actionsPanel.querySelector("input[name='"+ buttonId+"']");
      replBtn.classList.add('ext-timeout-btn');
      replBtn.setAttribute('value',btnText);
    }
  
</script>
<jsp:scriptlet> <![CDATA[ if (!sc.hasContextBits(curam.omega3.taglib.ScreenContext.EXTAPP)) { out.print("<script type=\"text/javascript\" src=\"" + pageContext.getAttribute("o3__serverURL") + "CDEJ/jscript/SPMUIComponents/spm-uicomponents-main.bundle.js\"> dummy script content</script>"); } ]]>
</jsp:scriptlet>
</head> <jsp:scriptlet> <![CDATA[pageContext .setAttribute( "appID", curam.omega3.util.UserUtils .getApplicationID((javax.servlet.http.HttpServletRequest) pageContext .getRequest()));]]>
</jsp:scriptlet>
<jsp:scriptlet> <![CDATA[pageContext.setAttribute("safeLandmarkLabel", XMLEscaper .escapeXML((String) pageContext .getAttribute("landmarkLabel")));]]>
</jsp:scriptlet> <body id="Curam_modal-message-dialog" class="${classDirection} ${appID} basic modal soria ${ccsBodyCuramInternal} ${pageLocale} ${highContrastClassName}" role="document" aria-label="${safeLandmarkLabel}" tabindex="-1" onload="return setFocusOnMessage()"> <cing:page pageID="max-tabs-info"> <div id="content-session-timeout-warning" class="spm-component"> <div class="bx--modal-content"> <div id="userMessage" class="user-message" tabindex="0"> </div> <div id="displayTimer" class="modal-timer" role="timer" aria-relevant="additions" aria-live="assertive"> &#x202A;<span id="minutesComp" aria-live="polite">&#xa0;</span> : <span id="secondsComp" aria-live="assertive">&#xa0;</span>&#x202C; </div> </div> </div> <div id="content"> <cing:form method="post" returnToSelf="false"> <div class="action-set hidden-action-set center"> <input type="button" name="__o3btn.cancel" value="cancel" id="__o3btn.cancel" title="cancel" class="hidden-button" tabindex="-1" onclick="confirmStay()"/> <input type="button" name="__o3btn.confirm" value="confirm" id="__o3btn.confirm" class="hidden-button" title="confirm" tabindex="-1" onclick="confirmTimeout()"/> </div> </cing:form> </div> <div region="bottom" id="actions-panel" class="actions-panel"> <div id="buttons-session-timeout-warning" class="action-set buttons right"> <curam:button name="cancel" dataTestidComponentPrefix="link" labelProp="__o3btn.cancel" cssClass="submit replace" type="button" onclick="confirmStay()"> </curam:button> <curam:button name="confirm" dataTestidComponentPrefix="link" labelProp="__o3btn.confirm" cssClass="submit replace" type="button" onclick="confirmTimeout()"> </curam:button> <script type="text/javascript">
							<jsp:text><![CDATA[dojo.addOnLoad(function() {
								require([ "curam/util/SessionTimeout",
										"curam/util", "dojo/dom" ], function(
										st, u, dom) {
									sessTimeout = st;
									
									let config = st.getTimeoutWarningConfig(),
                                        isExt = 
                                        	curam.util.getTopmostWindow().jsScreenContext.hasContextBits("EXTAPP");
									if (isExt) {
                                      useLocalButton('confirm', config.quitBtnTxt);
                                      useLocalButton('cancel', config.continueBtnTxt);
                                    } else {
                                      u.replaceSubmitButton('confirm', config.quitBtnTxt, true, undefined, true);
                                      u.replaceSubmitButton('cancel', config.continueBtnTxt);
                                    }
									st.displayUserMsgAsParagraphs(config.userMessageTxt, dom.byId('userMessage'));
									st.initTimer(config, curam.dialog._id + "_title");
								});
							});
							]]></jsp:text>
						</script> </div> </div> </cing:page>
</body> </html>
</jsp:root>