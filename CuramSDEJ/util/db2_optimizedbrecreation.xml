<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM

  Copyright IBM Corporation 2012. All Rights Reserved.

  US Government Users Restricted Rights - Use, duplication or disclosure
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->
<!--

  This is the ant file for speeding up the re-creation of tables on a DB2 development database.

-->
<project name="db2_optimizedbrecreation" default="main">

  <property environment="env."/>

  <!--  ***************************  -->
  <!--  ***  Import Properties  ***  -->
  <!--  ***************************  -->
  <import file="${env.CURAMSDEJ}/bin/app_properties.xml" />
  <import file="${env.CURAMSDEJ}/bin/app_utilities.xml" />

  <!--  *********************************  -->
  <!--  ***   D B 2  O P T I M I S E  ***  -->
  <!--  *********************************  -->
  <target name="main" depends="get.decrypted.db.password"
    description="Speed up the recreation of tables on a DB2 development database">

    <echo message="Optimising Database..."/>
    <sql
       driver="com.ibm.db2.jcc.DB2Driver"
       url="jdbc:db2://${curam.db.servername}:${curam.db.serverport}/${curam.db.name}"
       userid="${curam.db.username}"
       password="${decrypted.db.password}"
       autocommit="true"
       encoding="UTF-8"
       onerror="abort">
      <transaction>
         ALTER TABLESPACE USERSPACE1 DROPPED TABLE RECOVERY OFF;
         ALTER TABLESPACE ${curam.db.name}_L DROPPED TABLE RECOVERY OFF;
       </transaction>
      <connectionProperty name="sslConnection" value="${curam.db2.ssl}"/>
       <classpath>
         <path refid="database.common.classpath"/>
       </classpath>
    </sql>

  </target>

</project>

