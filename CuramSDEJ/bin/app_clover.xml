<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM

  Copyright IBM Corporation 2012. All Rights Reserved.

  US Government Users Restricted Rights - Use, duplication or disclosure
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->
<!--

  This is the ant clover file for Curam projects.
  It includes tasks for running clover, and producing reports.

-->
<project name="app_clover" default="clover.server">

  <!--  ****************  -->
  <!--  ***  CLOVER  ***  -->
  <!--  ****************  -->
  <!-- Set up a for clover code coverage             -->
  <property name="clover.initstring" location="${dir.sde}/clover/database/mycoverage.db"/>

  <property name="clover.includes"
    value="**/impl/**
           **/loaders/**
           **/test/**
           **/functions/**
           "/>
  <property name="clover.excludes"
    value="**/AuditMappings.java
           "/>

  <path id="clover.classpath">
    <pathelement path="${jar.clover}"/>
  </path>

  <target name="define.clover" if="have.clover">
    <taskdef resource="cloverlib.xml" classpath="${jar.clover}"/>
  </target>

  <target name="find.clover">
    <available file="${jar.clover}" property="have.clover" />
  </target>

  <target name="with.clover" depends="find.clover, define.clover">
    <property name="use.clover" value="true"/>
    <mkdir dir="${dir.sde}/clover/database"/>
    <clover-setup initString="${clover.initstring}"/>
  </target>

  <target name="clover.historypoint" depends="with.clover">
    <mkdir dir="${dir.sde}/clover/history"/>
    <clover-historypoint historyDir="${dir.sde}/clover/history" />
  </target>

  <target name="clover.report.html" depends="with.clover">
    <mkdir dir="${base.dir}/clover/clover_html"/>
    <clover-report>
      <current outfile="${base.dir}/clover/clover_html" title="EJBServer">
        <format type="html" orderBy="alpha"/>
      </current>
    </clover-report>
  </target>

  <property name="clover.threshold" value="5%"/>
  <property name="clover.range" value="25"/>
  <property name="clover.interval" value="1w"/>

  <target name="clover.historyreport" depends="with.clover">
    <clover-report>
      <historical outfile="${base.dir}/clover/clover_history"
          historyDir="${dir.sde}/clover/history"
          dateFormat="yyyyMMddHHmm"
          title="EJBServer Historical">
        <format type="html"/>
        <coverage/>
        <metrics/>
        <movers threshold="${clover.threshold}" range="${clover.range}" interval="${clover.interval}"/>
      </historical>
    </clover-report>
  </target>

  <target name="clover.report.viewer" depends="with.clover">
    <clover-view/>
  </target>

  <target name="clover.server" depends="with.clover, server">
  </target>

  <target name="clover.supplement" depends="with.clover, supplement">
  </target>

</project>