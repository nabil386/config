/* Copyright IBM Corp. 2009-2016  All Rights Reserved. */!function(){var e=!1,t=function(t,i){function n(){var e=arguments,t=this.getContentElement("advanced","txtdlgGenStyle");t&&t.commit.apply(t,e),this.foreach(function(t){t.commit&&"txtdlgGenStyle"!=t.id&&t.commit.apply(t,e)})}function a(e){if(!s){s=1;var t=this.getDialog(),i=t.imageElement;if(i){this.commit(d,i),e=[].concat(e);for(var n,a=e.length,l=0;a>l;l++)n=t.getContentElement.apply(t,e[l].split(":")),n&&n.setup(d,i)}s=0}}function l(e){var i=!0,n=e.getContentElement("Upload","browseFileButton").getInputElement().$,a=e.getContentElement("Upload","selectedFile").getInputElement().$,l=g.test(a.value),o=null;if(!l&&a.value!==t.lang.ibmuploadimage.ibm.noFileChosen)return alert(t.lang.ibmuploadimage.ibm.notImageFile),loadingImage.setStyle("visibility","hidden"),i=!1;if(!a||!a.value||""===a.value||a.value===t.lang.ibmuploadimage.ibm.noFileChosen)return i=!1,alert(t.lang.ibmuploadimage.ibm.notImageFile),i;if(CKEDITOR.env.ie&&CKEDITOR.env.version<10)try{var s=new ActiveXObject("Scripting.FileSystemObject"),r=s.getFile(a.value);o=r.size,n=r}catch(m){return"undefined"!=typeof console&&console.log(m.message),void alert(t.lang.ibmuploadimage.ibm.enableActiveX)}else o=n.files[0]&&n.files[0].size||null;return o?o&&o/1048576>U?(alert(t.lang.ibmuploadimage.ibm.imageSize),loadingImage.setStyle("visibility","hidden"),i=!1):i:i=!1}function o(t,i,n){var a,l=!1,o=-1,s=i.getContentElement("Upload","browseFileButton").getInputElement().$,r=s.parentNode,g=i.getButton("progressButton").getChild(0).getElement();if(CKEDITOR.env.ie&&CKEDITOR.env.version<10){var d=document.getElementById(i.getContentElement("Upload","browseFileButton")._.frameId),h=d.contentWindow.document.getElementsByTagName("html")[0].innerHTML;h="<html>"+h+"</html>";var u=d.cloneNode(!0);i.on("cancel",function(e){l=!0});var c=function(){"undefined"==typeof t._.filebrowserSe&&(t._.filebrowserSe={getDialog:function(){return{getContentElement:function(){return{reset:function(){}}}}},"for":[],filebrowser:{onSelect:function(){}}}),d.detachEvent("onreadystatechange",c)};d.attachEvent("onreadystatechange",c);var p=function(){if(O){var i=parseInt(O);i>0&&(m=setTimeout(function(){var i=d.parentNode;d.removeNode(!0),i.appendChild(u),u.contentWindow.document.open(),u.contentWindow.document.writeln(h),u.contentWindow.document.close(),g.setStyle("visibility","hidden"),alert(t.lang.ibmuploadimage.ibm.fileUploadTimeout),e=!1,m=null},i))}d.detachEvent("onreadystatechange",p)};d.attachEvent("onreadystatechange",p),e||(d.attachEvent("onload",function(){try{var n=d.contentWindow.document.getElementsByTagName("head")[0].innerHTML,a=n.match(/(<script[^>]*>)?\W*window\.parent\.CKEDITOR\.tools\.callFunction\(\W*\d*\W*,\W*\[["']{1}(.*?)["']{1}\]\W*\);?\W*(<\/script>)?/i);if(a&&!l){m&&clearTimeout(m);var o=i.getContentElement("info","txtUrl").getInputElement().$;o.value=a[2],i.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),i.fire("ok",{hide:!0}).hide!==!1&&(i.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),i.hide())}else{m&&clearTimeout(m);var s=d.parentNode;d.removeNode(!0),s.appendChild(u),u.contentWindow.document.open(),u.contentWindow.document.writeln(h),u.contentWindow.document.close(),g.setStyle("visibility","hidden"),e=!1}}catch(r){if(m&&clearTimeout(m),"unknown"==typeof d.contentWindow)return void clearTimeout(m);var s=d.parentNode;d.removeNode(!0),s.appendChild(u),u.contentWindow.document.open(),u.contentWindow.document.writeln(h),u.contentWindow.document.close(),g.setStyle("visibility","hidden"),alert(t.lang.ibmuploadimage.ibm.serverUnreachable),e=!1}}),e=!0),r.submit()}else{o=new XMLHttpRequest,a=new FormData,a.append("file",s.files[0]);try{if(o.open("POST",r.action,!0),o.onreadystatechange=function(){if(o.status&&4==o.readyState)if(200==o.status){var e=o.responseText.match(/(<script[^>]*>)?\W*window\.parent\.CKEDITOR\.tools\.callFunction\(\W*\d*\W*,\W*\[["']{1}(.*?)["']{1}\]\W*\);?\W*(<\/script>)?/i);e&&CKEDITOR.tools.callFunction(n,e[2],i)}else l=!0,alert(t.lang.ibmuploadimage.ibm.serverUnreachable),g.setStyle("visibility","hidden")},o.send(a),i.on("cancel",function(e){o.abort(),l=!0}),O){var b=parseInt(O);b>0&&setTimeout(function(){200===o.status||l||(o.abort(),alert(t.lang.ibmuploadimage.ibm.fileUploadTimeout),g.setStyle("visibility","hidden"))},b)}}catch(v){l=!0}}}var s,r,m,g,d=1,h=2,u=4,c=8,p=/^\s*(\d+)((px)|\%)?\s*$/i,b=/(^\s*(\d+)((px)|\%)?\s*$)|^$/i,v=/^\d+px$/,f=function(){var e=this.getValue(),t=this.getDialog(),i=e.match(p);if(i&&("%"==i[2]&&E(t,!1),e=i[1]),t.lockRatio){var n=t.originalElement;"true"==n.getCustomData("isReady")&&("txtHeight"==this.id?(e&&"0"!=e&&(e=Math.round(n.$.width*(e/n.$.height))),isNaN(e)||t.setValueOf("info","txtWidth",e)):(e&&"0"!=e&&(e=Math.round(n.$.height*(e/n.$.width))),isNaN(e)||t.setValueOf("info","txtHeight",e)))}y(t)},y=function(e){return e.originalElement&&e.preview?(e.commitContent(u,e.preview),0):1},E=function(e,t){if(!e.getContentElement("info","ratioLock"))return null;var i=e.originalElement;if(!i)return null;if("check"==t){if(!e.userlockRatio&&"true"==i.getCustomData("isReady")){var n=e.getValueOf("info","txtWidth"),a=e.getValueOf("info","txtHeight"),l=1e3*i.$.width/i.$.height,o=1e3*n/a;e.lockRatio=!1,n||a?isNaN(l)||isNaN(o)||Math.round(l)==Math.round(o)&&(e.lockRatio=!0):e.lockRatio=!0}}else void 0!=t?e.lockRatio=t:(e.userlockRatio=1,e.lockRatio=!e.lockRatio);var s=CKEDITOR.document.getById(x);if(e.lockRatio?s.removeClass("cke_btn_unlocked"):s.addClass("cke_btn_unlocked"),s.setAttribute("aria-checked",e.lockRatio),CKEDITOR.env.hc){var r=s.getChild(0);r.setHtml(e.lockRatio?CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢")}return e.lockRatio},C=function(e){var t=e.originalElement;if("true"==t.getCustomData("isReady")){var i=e.getContentElement("info","txtWidth"),n=e.getContentElement("info","txtHeight");i&&i.setValue(t.$.width),n&&n.setValue(t.$.height)}y(e)},I=function(e,t){function i(e,t){var i=e.match(p);return i?("%"==i[2]&&(i[1]+="%",E(n,!1)),i[1]):t}if(e==d){var n=this.getDialog(),a="",l="txtWidth"==this.id?"width":"height",o=t.getAttribute(l);o&&(a=i(o,a)),a=i(t.getStyle(l),a),this.setValue(a)}},w=function(){var e=this.originalElement,t=CKEDITOR.document.getById(D);e.setCustomData("isReady","true"),e.removeListener("load",w),e.removeListener("error",S),e.removeListener("abort",S),t&&t.setStyle("display","none"),this.dontResetSize||C(this),this.firstLoad&&CKEDITOR.tools.setTimeout(function(){E(this,"check")},0,this),this.firstLoad=!1,this.dontResetSize=!1},S=function(){var e=this.originalElement,t=CKEDITOR.document.getById(D);e.removeListener("load",w),e.removeListener("error",S),e.removeListener("abort",S);var i=CKEDITOR.getUrl(CKEDITOR.plugins.get("ibmuploadimage").path+"images/noimage.png");this.preview&&this.preview.setAttribute("src",i),t&&t.setStyle("display","none"),E(this,!1)},k=function(e){return CKEDITOR.tools.getNextId()+"_"+e},x=k("btnLockSizes"),R=k("btnResetSize"),D=k("ImagePreviewLoader"),T=k("previewLink"),L=k("previewImage"),O=t.config.ibmUploadImage.timeout,U=t.config.ibmUploadImage.maxFileSizeLimit;if(null!=t.config.ibmUploadImage.supportedFileType){g="\\.(";for(type in t.config.ibmUploadImage.supportedFileType)g+=t.config.ibmUploadImage.supportedFileType[type]+"|";g=g.substring(0,g.length-1),g+=")$",g=new RegExp(g,"i")}else g=/\.(gif|jpg|jpeg|tiff|png|svg)$/i;var K=CKEDITOR.tools.addFunction(function(e,t){var i=t.getContentElement("info","txtUrl").getInputElement().$;i.value=e,t.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),t.fire("ok",{hide:!0}).hide!==!1&&(t.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),t.hide())},this),A=function(){return null!=t.config.ibmUploadImage.uploadImage?t.config.ibmUploadImage.uploadImage:o}(),B=function(){return null!=t.config.ibmUploadImage.validate?t.config.ibmUploadImage.validate:l}();return{title:t.lang.ibmuploadimage["image"==i?"title":"titleButton"],minWidth:220,minHeight:50,onShow:function(){this.imageElement=!1,this.linkElement=!1,this.imageEditMode=!1,this.linkEditMode=!1,this.lockRatio=!0,this.userlockRatio=0,this.dontResetSize=!1,this.firstLoad=!0,this.addLink=!1;var e=this.getParentEditor(),t=e.getSelection(),n=t&&t.getSelectedElement(),a=n&&e.elementPath(n).contains("a",1),l=CKEDITOR.document.getById(D);l&&l.setStyle("display","none"),r=new CKEDITOR.dom.element("img",e.document),this.preview=CKEDITOR.document.getById(L),this.originalElement=e.document.createElement("img"),this.originalElement.setAttribute("alt",""),this.originalElement.setCustomData("isReady","false");var o=this.definition.dialog.getContentElement("info","imageLinkLabel"),s=this.definition.dialog.getContentElement("info","txtUrl2");if(o&&s&&s.getInputElement().setAttribute("aria-describedby",o.domId),a){this.linkElement=a,this.linkEditMode=!0;var m=a.getChildren();if(1==m.count()){var g=m.getItem(0).getName();("img"==g||"input"==g)&&(this.imageElement=m.getItem(0),"img"==this.imageElement.getName()?this.imageEditMode="img":"input"==this.imageElement.getName()&&(this.imageEditMode="input"))}"image"==i&&this.setupContent(h,a)}this.customImageElement?(this.imageEditMode="img",this.imageElement=this.customImageElement,delete this.customImageElement):(n&&"img"==n.getName()&&!n.data("cke-realelement")||n&&"input"==n.getName()&&"image"==n.getAttribute("type"))&&(this.imageEditMode=n.getName(),this.imageElement=n),this.imageEditMode?(this.cleanImageElement=this.imageElement,this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(d,this.imageElement),this.selectPage("info")):this.imageElement=e.document.createElement("img"),E(this,!0),CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display","none"))},onOk:function(){if(this.imageEditMode){var e=this.imageEditMode;"image"==i&&"input"==e&&confirm(t.lang.ibmuploadimage.button2Img)?(e="img",this.imageElement=t.document.createElement("img"),this.imageElement.setAttribute("alt",""),t.insertElement(this.imageElement)):"image"!=i&&"img"==e&&confirm(t.lang.ibmuploadimage.img2Button)?(e="input",this.imageElement=t.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),t.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==i?this.imageElement=t.document.createElement("img"):(this.imageElement=t.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt","");this.linkEditMode||(this.linkElement=t.document.createElement("a")),this.commitContent(d,this.imageElement),this.commitContent(h,this.linkElement),this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style"),this.imageEditMode?!this.linkEditMode&&this.addLink?(t.insertElement(this.linkElement),this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(t.getSelection().selectElement(this.linkElement),t.insertElement(this.imageElement)):this.addLink?this.linkEditMode?t.insertElement(this.imageElement):(t.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):t.insertElement(this.imageElement)},onLoad:function(){"image"!=i&&this.hidePage("Link");var e=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(e.getById(x),12),this.addFocusable(e.getById(R),13)),this.commitContent=n},onCancel:function(){var e=this.getButton("progressButton").getChild(0).getElement();e&&e.setStyle("visibility","hidden")},onHide:function(){this.preview&&this.commitContent(c,this.preview),this.originalElement&&(this.originalElement.removeListener("load",w),this.originalElement.removeListener("error",S),this.originalElement.removeListener("abort",S),this.originalElement.remove(),this.originalElement=!1),delete this.imageElement},contents:[{id:"Upload",filebrowser:"uploadButton",label:t.lang.ibmuploadimage.upload,accessKey:"U",elements:[{type:"vbox",padding:0,width:340,children:[{type:"hbox",padding:0,children:[{type:"html",id:"fileUploadLabel",style:"margin:0; padding-bottom: 15px; width:100%;",html:"<div>"+CKEDITOR.tools.htmlEncode(t.lang.ibmuploadimage.ibm.fileUpload)+"</div>"}]},{type:"hbox",padding:0,style:"display:none;",children:[{type:"file",id:"browseFileButton",label:t.lang.ibmuploadimage.ibm.fileUpload,style:"display:none;",onChange:function(){var e=this.getDialog(),i=e.getContentElement("Upload","selectedFile").getInputElement().$;i.value=""!==this.getValue()?this.getValue():t.lang.ibmuploadimage.ibm.noFileChosen}},{type:"fileButton",id:"uploadButton",filebrowser:{action:"QuickUpload",target:"info:txtUrl",url:null!=t.config.ibmUploadImage.uploadUrl&&""!=t.config.ibmUploadImage.uploadUrl?t.config.ibmUploadImage.uploadUrl:t.config.ibmBinaryImageUploadUrl},style:"display:none;",label:t.lang.ibmuploadimage.btnUpload,"for":["Upload","browseFileButton"]}]},{type:"hbox",padding:0,style:"height:300px;",widths:["20%","80%"],children:[{type:"button",id:"browseFile",label:t.lang.ibmuploadimage.ibm.browseFile,onLoad:function(){var e=this.getDialog().getContentElement("Upload","fileUploadLabel");e&&this.getInputElement().setAttribute("aria-describedby",e.domId),this.getInputElement().setAttribute("class","cke_dialog_ui_primary_button"),this.getInputElement().getChildren().getItem(0).setAttribute("class","cke_dialog_ui_primary_button")},onClick:function(){var e=this.getDialog(),t=e.getContentElement("Upload","browseFileButton").getInputElement().$;t.click()}},{type:"text",id:"selectedFile",label:t.lang.ibmuploadimage.ibm.file,labelStyle:"display:none",style:"padding-left: 10px;",size:38,className:"cke_disabled",onLoad:function(){this.getInputElement().getParent().setStyle("border","none"),this.getInputElement().getParent().setStyle("background","white"),this.getInputElement().setStyle("background","white"),this.setValue(t.lang.ibmuploadimage.ibm.noFileChosen),this.getInputElement().setAttribute("readOnly",!0),this.getElement().on("keydown",function(e){13==e.data.$.keyCode&&e.data.$.stopPropagation()},this.getDialog())},onShow:function(){""==this.getValue()&&this.setValue(t.lang.ibmuploadimage.ibm.noFileChosen),this.getInputElement().setStyle("background","white"),this.getInputElement().setAttribute("readOnly",!0)}}]}]}]},{id:"info",label:t.lang.ibmuploadimage.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,style:"margin:0; padding: 0; width:100%;",children:[{type:"html",id:"imageLinkLabel",style:"margin:0; padding: 0; width:100%;",html:"<div>"+CKEDITOR.tools.htmlEncode(t.lang.ibmuploadimage.ibm.imageLinkLabel)+"</div>"}]},{type:"hbox",padding:0,children:[{id:"txtUrl2",type:"text",label:t.lang.ibmuploadimage.ibm.linkLabel,labelLayout:"horizontal",widths:["13%","87%"],style:"width:100%","default":"",onShow:function(){this.getElement().findOne("td").removeClass("cke_dialog_ui_hbox_first").setStyle("vertical-align","middle")},setup:function(e,t){if(e==h){var i=t.data("cke-saved-href");i||(i=t.getAttribute("href")),this.setValue(i)}},commit:function(e,i){if(e==h&&(this.getValue()||this.isChanged())){var n=this.getValue();i.data("cke-saved-href",n),i.setAttribute("href",n),(this.getValue()||!t.config.image_removeLinkByEmptyURL)&&(this.getDialog().addLink=!0)}}}]},{type:"hbox",padding:0,children:[{id:"cmbTarget",type:"select",style:"width:100%",requiredContent:"a[target]",label:t.lang.common.target,labelLayout:"horizontal",widths:["13%","87%"],"default":"",onShow:function(){this.getElement().findOne("td").removeClass("cke_dialog_ui_hbox_first").setStyle("vertical-align","middle")},items:[[t.lang.common.notSet,""],[t.lang.common.targetNew,"_blank"],[t.lang.common.targetTop,"_top"],[t.lang.common.targetSelf,"_self"],[t.lang.common.targetParent,"_parent"]],setup:function(e,t){e==h&&this.setValue(t.getAttribute("target")||"")},commit:function(e,t){e==h&&(this.getValue()||this.isChanged())&&t.setAttribute("target",this.getValue())}}]},{type:"vbox",padding:0,widths:[20,80],children:[{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:t.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:t.lang.common.browseServer},{id:"txtUrl",type:"text",label:t.lang.common.url,required:!0,onChange:function(){var e=this.getDialog(),t=this.getValue();if(t.length>0){e=this.getDialog();var i=e.originalElement;e.preview&&e.preview.removeStyle("display"),i.setCustomData("isReady","false");var n=CKEDITOR.document.getById(D);n&&n.setStyle("display",""),i.on("load",w,e),i.on("error",S,e),i.on("abort",S,e),i.setAttribute("src",t),e.preview&&(r.setAttribute("src",t),e.preview.setAttribute("src",r.$.src),y(e))}else e.preview&&(e.preview.removeAttribute("src"),e.preview.setStyle("display","none"))},setup:function(e,t){if(e==d){var i=t.data("cke-saved-src")||t.getAttribute("src"),n=this;this.getDialog().dontResetSize=!0,n.setValue(i),n.setInitValue()}},commit:function(e,t){e==d&&(this.getValue()||this.isChanged())?(t.data("cke-saved-src",this.getValue()),t.setAttribute("src",this.getValue())):e==c&&(t.setAttribute("src",""),t.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(t.lang.ibmuploadimage.urlMissing)},{type:"button",id:"browse",style:"display:inline-block;margin-top:14px;",align:"center",label:t.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"},{id:"txtAlt",type:"text",label:t.lang.ibmuploadimage.alt,accessKey:"T","default":"",onChange:function(){y(this.getDialog())},setup:function(e,t){e==d&&this.setValue(t.getAttribute("alt"))},commit:function(e,t){e==d?(this.getValue()||this.isChanged())&&t.setAttribute("alt",this.getValue()):e==u?t.setAttribute("alt",this.getValue()):e==c&&t.removeAttribute("alt")}},{type:"hbox",requiredContent:"img{width,height}",children:[{type:"text",id:"txtWidth",label:t.lang.common.width,onKeyUp:f,onChange:function(){a.call(this,"advanced:txtdlgGenStyle")},validate:function(){var e=this.getValue().match(b),i=!(!e||0===parseInt(e[1],10));return i||alert(t.lang.common.invalidWidth),i},setup:I,commit:function(e,i,n){var a=this.getValue();if(e==d)a&&t.activeFilter.check("img{width,height}")?i.setStyle("width",CKEDITOR.tools.cssLength(a)):i.removeStyle("width"),!n&&i.removeAttribute("width");else if(e==u){var l=a.match(p);if(l)i.setStyle("width",CKEDITOR.tools.cssLength(a));else{var o=this.getDialog().originalElement;"true"==o.getCustomData("isReady")&&i.setStyle("width",o.$.width+"px")}}else e==c&&(i.removeAttribute("width"),i.removeStyle("width"))}},{type:"text",id:"txtHeight",label:t.lang.common.height,onKeyUp:f,onChange:function(){a.call(this,"advanced:txtdlgGenStyle")},validate:function(){var e=this.getValue().match(b),i=!(!e||0===parseInt(e[1],10));return i||alert(t.lang.common.invalidHeight),i},setup:I,commit:function(e,i,n){var a=this.getValue();if(e==d)a&&t.activeFilter.check("img{width,height}")?i.setStyle("height",CKEDITOR.tools.cssLength(a)):i.removeStyle("height"),!n&&i.removeAttribute("height");else if(e==u){var l=a.match(p);if(l)i.setStyle("height",CKEDITOR.tools.cssLength(a));else{var o=this.getDialog().originalElement;"true"==o.getCustomData("isReady")&&i.setStyle("height",o.$.height+"px")}}else e==c&&(i.removeAttribute("height"),i.removeStyle("height"))}}]},{type:"hbox",requiredContent:"img{width,height}",children:[{type:"text",id:"txtHSpace",requiredContent:"img{margin-left,margin-right}",label:t.lang.ibmuploadimage.hSpace,"default":"",onKeyUp:function(){y(this.getDialog())},onChange:function(){a.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(t.lang.ibmuploadimage.validateHSpace),setup:function(e,t){if(e==d){var i,n,a,l=t.getStyle("margin-left"),o=t.getStyle("margin-right");l=l&&l.match(v),o=o&&o.match(v),n=parseInt(l,10),a=parseInt(o,10),i=n==a&&n,isNaN(parseInt(i,10))&&(i=t.getAttribute("hspace")),this.setValue(i)}},commit:function(e,t,i){var n=parseInt(this.getValue(),10);e==d||e==u?(isNaN(n)?!n&&this.isChanged()&&(t.removeStyle("margin-left"),t.removeStyle("margin-right")):(t.setStyle("margin-left",CKEDITOR.tools.cssLength(n)),t.setStyle("margin-right",CKEDITOR.tools.cssLength(n))),i||e!=d||t.removeAttribute("hspace")):e==c&&(t.removeAttribute("hspace"),t.removeStyle("margin-left"),t.removeStyle("margin-right"))}},{type:"text",id:"txtVSpace",requiredContent:"img{margin-top,margin-bottom}",label:t.lang.ibmuploadimage.vSpace,"default":"",onKeyUp:function(){y(this.getDialog())},onChange:function(){a.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(t.lang.ibmuploadimage.validateVSpace),setup:function(e,t){if(e==d){var i,n,a,l=t.getStyle("margin-top"),o=t.getStyle("margin-bottom");l=l&&l.match(v),o=o&&o.match(v),n=parseInt(l,10),a=parseInt(o,10),i=n==a&&n,isNaN(parseInt(i,10))&&(i=t.getAttribute("vspace")),this.setValue(i)}},commit:function(e,t,i){var n=parseInt(this.getValue(),10);e==d||e==u?(isNaN(n)?!n&&this.isChanged()&&(t.removeStyle("margin-top"),t.removeStyle("margin-bottom")):(t.setStyle("margin-top",CKEDITOR.tools.cssLength(n)),t.setStyle("margin-bottom",CKEDITOR.tools.cssLength(n))),i||e!=d||t.removeAttribute("vspace")):e==c&&(t.removeAttribute("vspace"),t.removeStyle("margin-top"),t.removeStyle("margin-bottom"))}}]},{type:"hbox",requiredContent:"img{width,height}",children:[{id:"cmbAlign",requiredContent:"img{float}",type:"select",style:"width:100%",label:t.lang.common.align,"default":"",items:[[t.lang.common.notSet,""],[t.lang.common.alignLeft,"left"],[t.lang.common.alignRight,"right"]],onChange:function(){y(this.getDialog()),a.call(this,"advanced:txtdlgGenStyle")},setup:function(e,t){if(e==d){var i=t.getStyle("float");switch(i){case"inherit":case"none":i=""}!i&&(i=(t.getAttribute("align")||"").toLowerCase()),this.setValue(i)}},commit:function(e,t,i){var n=this.getValue();if(e==d||e==u){if(n?t.setStyle("float",n):t.removeStyle("float"),!i&&e==d)switch(n=(t.getAttribute("align")||"").toLowerCase()){case"left":case"right":t.removeAttribute("align")}}else e==c&&t.removeStyle("float")}},{type:"text",id:"txtBorder",requiredContent:"img{border-width}",label:t.lang.ibmuploadimage.border,"default":"",onKeyUp:function(){y(this.getDialog())},onChange:function(){a.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(t.lang.ibmuploadimage.validateBorder),setup:function(e,t){if(e==d){var i,n=t.getStyle("border-width");n=n&&n.match(/^(\d+px)(?: \1 \1 \1)?$/),i=n&&parseInt(n[1],10),isNaN(parseInt(i,10))&&(i=t.getAttribute("border")),this.setValue(i)}},commit:function(e,t,i){var n=parseInt(this.getValue(),10);e==d||e==u?(isNaN(n)?!n&&this.isChanged()&&t.removeStyle("border"):(t.setStyle("border-width",CKEDITOR.tools.cssLength(n)),t.setStyle("border-style","solid")),i||e!=d||t.removeAttribute("border")):e==c&&(t.removeAttribute("border"),t.removeStyle("border-width"),t.removeStyle("border-style"),t.removeStyle("border-color"))}}]},{type:"hbox",widths:["5%","95%"],children:[{id:"ratioLock",type:"html",style:"margin-top:17px;width:"+(CKEDITOR.env.hc?"90px":"20px")+";height:50px;",onLoad:function(){var e=CKEDITOR.document.getById(R),t=CKEDITOR.document.getById(x);e&&(e.on("click",function(e){C(this),e.data&&e.data.preventDefault()},this.getDialog()),e.on("mouseover",function(){this.addClass("cke_btn_over")},e),e.on("mouseout",function(){this.removeClass("cke_btn_over")},e)),t&&(t.on("click",function(e){var t=(E(this),this.originalElement),i=this.getValueOf("info","txtWidth");if("true"==t.getCustomData("isReady")&&i){var n=t.$.height/t.$.width*i;isNaN(n)||(this.setValueOf("info","txtHeight",Math.round(n)),y(this))}e.data&&e.data.preventDefault()},this.getDialog()),t.on("mouseover",function(){this.addClass("cke_btn_over")},t),t.on("mouseout",function(){this.removeClass("cke_btn_over")},t))},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+t.lang.ibmuploadimage.lockRatio+'" class="cke_btn_locked" id="'+x+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+t.lang.ibmuploadimage.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+t.lang.ibmuploadimage.resetSize+'" class="cke_btn_reset" id="'+R+'" role="button"><span class="cke_label">'+t.lang.ibmuploadimage.resetSize+"</span></a></div>"},{type:"html",id:"htmlPreview",style:"width:100%;",html:function(){for(var e="<div>"+CKEDITOR.tools.htmlEncode(t.lang.common.preview)+'<br><div id="'+D+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+T+'"><img id="'+L+'" alt="" /></a>',i=0;15>i;i++)e+=t.lang.ibmuploadimage.ibm.previewText;return e+="</td></tr></table></div></div>"}()}]}]}]}],buttons:[{type:"hbox",id:"progressButton",children:[{id:"progress",type:"html",html:'<div style="float:left;padding-right: 60px;padding-top: 15px;" aria-live="polite" role="presentation"><img src="'+CKEDITOR.getUrl(CKEDITOR.plugins.get("ibmuploadimage").path+"images/loading.gif")+'" alt="'+t.lang.ibmuploadimage.ibm.inserting+'"> '+t.lang.ibmuploadimage.ibm.inserting+"</div>",onLoad:function(){this.getElement().setStyle("visibility","hidden")}}]},{id:"ok",type:"button",label:t.lang.ibmuploadimage.ibm.insertButtonLabel,title:t.lang.ibmuploadimage.ibm.insertTitle,"class":"cke_dialog_ui_button_ok",onClick:function(e){var i=e.data.dialog,n=!0;i.getButton("progressButton").getChild(0).getElement();"Upload"==i.definition.dialog._.currentTabId?(n=B(i),n&&(i.imageEditMode||i.getButton("progressButton").getChild(0).getElement().setStyle("visibility","visible"),A(t,i,K))):(i.imageEditMode||"Upload"!=i.definition.dialog._.currentTabId||i.getButton("progressButton").getChild(0).getElement().setStyle("visibility","visible"),i.fire("ok",{hide:!0}).hide!==!1&&(i.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),i.hide()))}},CKEDITOR.dialog.cancelButton]}};CKEDITOR.dialog.add("ibmuploadimage",function(e){return t(e,"image")}),CKEDITOR.dialog.add("imagebutton",function(e){return t(e,"imagebutton")})}();