/* Copyright IBM Corp. 2009-2016  All Rights Reserved. *//* Copyright IBM Corp. 2011-2014 All Rights Reserved.                    */
CKEDITOR.dialog.add("columnProperties",function(t){var e,i,n,l,a,o=function(){var a,o=t.getSelection(),d=o.getSelectedElement();if(!d||"td"!=d.getName()&&"th"!=d.getName()){var r=o.getCommonAncestor();a=r&&r instanceof CKEDITOR.dom.element&&("td"==r.getName()||"th"==r.getName())?r:r.getAscendant("td")?r.getAscendant("td"):r.getAscendant("th")}else a=d;if(a){l=a.getAscendant("tr");var m=l.getChildCount();e=-1,i=0;for(var g,c=0;m>c;c++)if(g=l.getChild(c),i+=g.getAttribute("colspan")?parseInt(g.getAttribute("colspan"),10):1,a.equals(l.getChild(c))){e=c;break}n=a.getAttribute("colspan")?parseInt(a.getAttribute("colspan"),10):1}},d=function(t){for(var e=0,l=-1,a=0;a<t.getChildCount();a++){if(currentCell=t.getChild(a),currentColspan=currentCell.getAttribute("colspan")?parseInt(currentCell.getAttribute("colspan"),10):1,e+=currentColspan,e==i){if(currentColspan==n){l=a;break}l=-1;break}if(e>i){l=-1;break}}return l},r=function(){if(a=new Array,-1!=e)for(var t,i,n,o=l.getAscendant("table"),r=0;r<o.getChildCount();r++)if(t=o.getChild(r),"thead"==t.getName()||"tbody"==t.getName())for(var m=0;m<t.getChildCount();m++)i=t.getChild(m),n=d(i),-1!=n&&a.push(i.getChild(n));return a};return{title:t.lang.ibmtabletools.columnTitle,minWidth:220,minHeight:50,onShow:function(){o();var t,e,i,n=!1,l=/^(\d+(?:\.\d+)?)(px|%|in|cm|mm|em|ex|pt|pc)$/,d=/^(\d+(?:\.\d+)?)$/;if(r(),a.length>0&&(i=a[0].getStyle("width")?a[0].getStyle("width"):a[0].getAttribute("width")),void 0==i)n=!0;else{var m=d.exec(i);m&&(i+="px");for(var g=1;g<a.length;g++)if(t=a[g].getStyle("width")?a[g].getStyle("width"):a[g].getAttribute("width"),m=d.exec(t),m&&(t+="px"),t!=i){n=!0;break}}!n&&i&&(e=l.exec(i),e&&this.setupContent(e))},onOk:function(){for(var t=0;t<a.length;t++)this.commitContent(a[t])},contents:[{id:"info",style:"width: 100%",elements:[{type:"hbox",children:[{label:t.lang.common.width,type:"text",id:"colWidth",setup:function(t){t&&t[1]&&this.setValue(t[1])},commit:function(t){var e=parseFloat(this.getValue(),10),i=this.getDialog().getValueOf("info","widthType");isNaN(e)?t.removeStyle("width"):t.setStyle("width",e+i),t.removeAttribute("width")},validate:CKEDITOR.dialog.validate.number(t.lang.ibmtabletools.invalidColumnWidth)},{type:"select",id:"widthType",label:t.lang.table.widthUnit,"default":"px",items:[[t.lang.table.widthPx,"px"],[t.lang.table.widthPc,"%"],[t.lang.ibm.common.widthIn,"in"],[t.lang.ibm.common.widthCm,"cm"],[t.lang.ibm.common.widthMm,"mm"],[t.lang.ibm.common.widthEm,"em"],[t.lang.ibm.common.widthEx,"ex"],[t.lang.ibm.common.widthPt,"pt"],[t.lang.ibm.common.widthPc,"pc"]],setup:function(t){t&&t[2]&&this.setValue(t[2])}}]}]}]}});