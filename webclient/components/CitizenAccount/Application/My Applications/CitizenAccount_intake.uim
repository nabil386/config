<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM
  
  Copyright IBM Corporation 2012. All Rights Reserved.
 
  US Government Users Restricted Rights - Use, duplication or disclosure 
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->  

<!-- Copyright (c) 20010 Curam Software Ltd.                                 -->
<!-- All rights reserved.                                                   -->
<!-- This software is the confidential and proprietary information of Curam -->
<!-- Software, Ltd. ("Confidential Information"). You shall not disclose    -->
<!-- such Confidential Information and shall use it only in accordance with -->
<!-- the terms of the license agreement you entered into with Curam         -->
<!-- Software.                                                              -->
<!-- Description -->
<!-- =========== -->
<!-- Page used to start the intake or to open the respective page in intake -->
<!-- from citizen account.    -->
<PAGE PAGE_ID="CitizenAccount_intake">

    <PAGE_TITLE>
      <CONNECT>
        <SOURCE NAME="TEXT" PROPERTY="page.title"/>
      </CONNECT>
    </PAGE_TITLE>


    <JSP_SCRIPTLET>
      <![CDATA[

        javax.servlet.http.HttpServletRequest hsRequest = (javax.servlet.http.HttpServletRequest) request;
        javax.servlet.http.HttpSession httpSession = hsRequest.getSession();

        String contextPath = request.getContextPath();

        String playerID = (String) httpSession.getAttribute("curam.page.playerExecutionID");
        String pageName = request.getParameter("page");
        String pageType = request.getParameter("pageType");
        String id = request.getParameter("id");
        
        String url;
        
        if(pageType != null && pageType.equalsIgnoreCase("resolve")) {
          url = contextPath + "/cw/ResolvePage.do?o3ctx=4096";
        } else {
          url = contextPath + "/cw/PlayerPage.do?o3ctx=4096";
        } 
      
        // route to the page name if passed or start the intake script 
        if( null == pageName) {
          // Call setup intake process
          url += "&page=SelectApplication";
        } else {
          url += "&page=" + curam.omega3.request.RequestUtils.escapeURL(pageName);
        }

        if(id != null) {
          url += "&id=" + curam.omega3.request.RequestUtils.escapeURL(id);
        }

        response.sendRedirect(response.encodeRedirectURL(url)); 
      ]]>
    </JSP_SCRIPTLET>
</PAGE>
