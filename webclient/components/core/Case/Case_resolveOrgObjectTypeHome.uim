<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM
  
  Copyright IBM Corporation 2012-2013. All Rights Reserved.
  
  US Government Users Restricted Rights - Use, duplication or disclosure 
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->
<!-- Copyright 2007-2008, 2010 Curam Software Ltd.                          -->
<!-- All rights reserved.                                                   -->
<!-- This software is the confidential and proprietary information of       -->
<!-- Curam Software, Ltd. ("Confidential Information").  You shall not      -->
<!-- disclose such Confidential Information and shall use it only in        -->
<!-- accordance with the terms of the license agreement you entered into    -->
<!-- with Curam Software.                                                   -->
<!-- Description                                                            -->
<!-- ===========                                                            -->
<!-- This jsp redirects the User, Org Unit, Position or Work Queue to their -->
<!-- home page                                    -->
<PAGE
  PAGE_ID="Case_resolveOrgObjectTypeHome"
  WINDOW_OPTIONS="width=900"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="file://Curam/UIMSchema.xsd"
>
  <JSP_SCRIPTLET>
    

      curam.omega3.request.RequestHandler
        rh = curam.omega3.request.RequestHandlerFactory.getRequestHandler(request);

      String context = request.getContextPath() + "/";
      context += curam.omega3.user.UserPreferencesFactory.getUserPreferences(pageContext.getSession()).getLocale() + "/";
      String orgObjectType = request.getParameter("orgObjectType");
      String userName = request.getParameter("userName");
      String orgObjectReference = request.getParameter("orgObjectReference");
      
      String url = "";
      String pageIdentifier = "";
      String organisationStructureID = "";
      String organisationUnitID = "";
      String positionID = "";
      String workQueueID= "";
           
     curam.interfaces.OrganizationPkg.Organization_resolveCaseOwnerHome_TH 
     th = new curam.interfaces.OrganizationPkg.Organization_resolveCaseOwnerHome_TH();
     
     th.setFieldValue(th.key$orgObjectType_idx,orgObjectType);
     th.setFieldValue(th.key$orgObjectReference_idx,orgObjectReference); 
      
     th.callServer();
 
    pageIdentifier=th.getFieldValue(th.result$pageIdentifier_idx);
    organisationStructureID=th.getFieldValue(th.result$organisationStructureID_idx);
   
    if (orgObjectType.equals("RL9")) {
       
       url = context + curam.omega3.request.RequestUtils.escapeURL(pageIdentifier) + "Page.do?userName=" + curam.omega3.request.RequestUtils.escapeURL(userName);
    
    }           
    else if (orgObjectType.equals("RL10")) {
           
           url = context + curam.omega3.request.RequestUtils.escapeURL(pageIdentifier) + "Page.do?organisationUnitID=" + curam.omega3.request.RequestUtils.escapeURL(orgObjectReference)
           + "&amp;organisationStructureID=" + curam.omega3.request.RequestUtils.escapeURL(organisationStructureID);
      
    }
     else if (orgObjectType.equals("RL21")) {
     
      organisationUnitID=th.getFieldValue(th.result$organisationUnitID_idx);
     
     url = context + curam.omega3.request.RequestUtils.escapeURL(pageIdentifier) + "Page.do?positionID=" + curam.omega3.request.RequestUtils.escapeURL(orgObjectReference)
     + "&amp;organisationStructureID=" + curam.omega3.request.RequestUtils.escapeURL(organisationStructureID)
     + "&amp;organisationUnitID=" + curam.omega3.request.RequestUtils.escapeURL(organisationUnitID);
      
    }
    else if (orgObjectType.equals("RL23")) {
        
        url = context + curam.omega3.request.RequestUtils.escapeURL(pageIdentifier) + "Page.do?workQueueID=" + curam.omega3.request.RequestUtils.escapeURL(orgObjectReference);
     
    } 
    else {
    
    url = context + curam.omega3.request.RequestUtils.escapeURL(pageIdentifier) + "Page.do?userName=" + curam.omega3.request.RequestUtils.escapeURL(userName);
    }

    url += "&amp;" + rh.getSystemParameters();
        
    response.sendRedirect(response.encodeRedirectURL(url));
      
    
  </JSP_SCRIPTLET>
</PAGE>
