<?xml version="1.0" encoding="UTF-8"?>

<!-- UIM to close modal and navigate to tab  -->
<!-- Task 60485: DEV: Implement- Informational message -->

<PAGE PAGE_ID="BDMCloseModalAndNavigateToTab"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="file://Curam/UIMSchema.xsd">

	<PAGE_PARAMETER NAME="wizardStateID"/>
	<PAGE_PARAMETER NAME="sourcePageAction"/>

	<JSP_SCRIPTLET>
		<![CDATA[

      	curam.omega3.request.RequestHandler
        	rh = curam.omega3.request.RequestHandlerFactory.getRequestHandler(request);


      	String context = request.getContextPath() + "/";
      	
      	context += curam.omega3.user.UserPreferencesFactory.getUserPreferences(pageContext.getSession()).getLocale() + "/";
      
      	String wizardStateID = request.getParameter("wizardStateID");
      	
      	String sourcePageAction = request.getParameter("sourcePageAction");
      	
		
      	String pageName="";
      	
      	String url = "";
      
      	curam.interfaces.BDMAddressEvidenceWizardPkg.BDMAddressEvidenceWizard_getAddressEvidenceWizardDetails_TH getTh = new curam.interfaces.BDMAddressEvidenceWizardPkg.BDMAddressEvidenceWizard_getAddressEvidenceWizardDetails_TH();
		
		getTh.setFieldValue(getTh.wizardStateID$wizardStateID_idx,wizardStateID);
		
		getTh.callServer();
			
		String editInd = getTh.getFieldValue(getTh.result$dtls$step1DataDtls$editInd_idx);
		
		String concernRoleID = getTh.getFieldValue(getTh.result$dtls$participantRoleID_idx);
		
		//if(editInd.equals("YN2") && sourcePageAction.equals("EditAddressEvidence") ) {
	      
	       pageName="PDCEvidence_listEvidence";
	      
	       url = context + curam.omega3.request.RequestUtils.escapeURL(pageName) + "Page.do?concernRoleID=" + curam.omega3.request.RequestUtils.escapeURL(concernRoleID);
	        	 url += "&" + rh.getSystemParameters();
	         
	       
	       response.sendRedirect(response.encodeRedirectURL(url));
	         	
		//}
	    
		]]>
	</JSP_SCRIPTLET>
</PAGE>