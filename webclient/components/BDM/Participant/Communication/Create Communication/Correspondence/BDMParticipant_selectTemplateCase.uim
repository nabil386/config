<?xml version="1.0" encoding="UTF-8"?>
<!-- Description                                                            -->
<!-- ===========                                                            -->
<!-- This page allows the user to select the template to generate correspondence.  -->
<PAGE xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
PAGE_ID="BDMParticipant_selectTemplateCase" 
WINDOW_OPTIONS="width=850,height=600" 
xsi:noNamespaceSchemaLocation="file://Curam/UIMSchema.xsd">

   <PAGE_TITLE>
      <CONNECT>
         <SOURCE NAME="TEXT" PROPERTY="PageTitle.StaticText1" />
      </CONNECT>
   </PAGE_TITLE>
   
   <PAGE_PARAMETER NAME="wizardStateID" />
   <PAGE_PARAMETER NAME="concernRoleID" />
   <PAGE_PARAMETER NAME="caseID" />
   
   <SERVER_INTERFACE CLASS="BDMCommunication" NAME="ACTION" OPERATION="searchTemplates" PHASE="ACTION" /> 
   <!-- <SERVER_INTERFACE CLASS="BDMCommunication" NAME="DISPLAYCATEGORY" OPERATION="getCategoryAndSubCategoryList" PHASE="DISPLAY" /> -->
   <SERVER_INTERFACE CLASS="BDMCommunication" NAME="DISPLAYCATEGORY" OPERATION="getSubCategorySearchCriteria" PHASE="DISPLAY" />
   <CLUSTER LABEL_WIDTH="25" NUM_COLS="1" TITLE="Cluster.Title.SearchCriteria">
      <FIELD LABEL="Field.Label.TemplateIDOrName" WIDTH="65">
         <CONNECT>
            <TARGET NAME="ACTION" PROPERTY="templateIDName" />
         </CONNECT>
      </FIELD>
   </CLUSTER>
   <CLUSTER LABEL_WIDTH="25" NUM_COLS="1" TITLE="Cluster.Title.Category">      
      <!--<FIELD LABEL="Field.Label.TemplateCategory" WIDTH="65" USE_BLANK="true">-->
         <!--  <SCRIPT ACTION="filterTemplateCategorySubCategoryDropDown()" EVENT="ONCHANGE" SCRIPT_FILE="BDMCorrespondence.js" />-->
        <!-- <CONNECT>
            <INITIAL HIDDEN_PROPERTY="result$dtls$categoryID" PROPERTY="result$dtls$categoryName" NAME="DISPLAYCATEGORY" />
         </CONNECT>
         <CONNECT>
            <TARGET PROPERTY="key$categoryID" NAME="ACTION" />
         </CONNECT>
      </FIELD>
      <FIELD LABEL="Field.Label.TemplateSubCategory" WIDTH="65" USE_BLANK="true">
         <CONNECT>
            <INITIAL HIDDEN_PROPERTY="result$dtls$subCategoryID" PROPERTY="result$dtls$subCategoryName" NAME="DISPLAYCATEGORY" />
         </CONNECT>
         <CONNECT>
            <TARGET PROPERTY="key$subCategoryID" NAME="ACTION" />
         </CONNECT>
      </FIELD>      -->
	<FIELD LABEL="Field.Label.TemplateCategory" WIDTH="65" USE_BLANK="true">
	  <SCRIPT ACTION="filterTemplateCategorySubCategoryDropDown()" EVENT="ONCHANGE" SCRIPT_FILE="BDMFilterDropDownItemsCategorySubCategory.js" />
		<CONNECT>
			<INITIAL HIDDEN_PROPERTY="result$categoryDtls$dtls$listCode" PROPERTY="result$categoryDtls$dtls$listValue" NAME="DISPLAYCATEGORY" />
	   </CONNECT>
	   <CONNECT>
			<SOURCE PROPERTY="result$categoryCode" NAME="DISPLAYCATEGORY" />
	   </CONNECT>
	   <CONNECT>
			<TARGET PROPERTY="key$categoryID" NAME="ACTION" />
	   </CONNECT>
    </FIELD>
	<FIELD LABEL="Field.Label.TemplateSubCategory" WIDTH="65" USE_BLANK="true">
		<CONNECT>
			<INITIAL HIDDEN_PROPERTY="result$subCategoryDtls$dtls$listCode" PROPERTY="result$subCategoryDtls$dtls$listValue" NAME="DISPLAYCATEGORY" />
	   </CONNECT>
	   <CONNECT>
			<SOURCE PROPERTY="result$subCategoryCode" NAME="DISPLAYCATEGORY" />
	   </CONNECT>
	   <CONNECT>
			<TARGET PROPERTY="key$subCategoryID" NAME="ACTION" />
	   </CONNECT>
    </FIELD>
   </CLUSTER>
   
   <CLUSTER>   
      <ACTION_SET TOP="false" ALIGNMENT="CENTER">
         <ACTION_CONTROL DEFAULT="true" IMAGE="SearchButton" LABEL="ActionControl.Label.Search" TYPE="SUBMIT">
            <LINK PAGE_ID="THIS" />
         </ACTION_CONTROL>
         
         <ACTION_CONTROL LABEL="ActionControl.PrevButton.label">
            <LINK DISMISS_MODAL="false" OPEN_MODAL="false" PAGE_ID="BDMParticipant_createCorrespondenceCase" SAVE_LINK="false">              
               <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="caseID" />
                  <TARGET NAME="PAGE" PROPERTY="caseID" />
               </CONNECT>
            </LINK>
         </ACTION_CONTROL>
         
         <ACTION_CONTROL IMAGE="ResetButton" LABEL="ActionControl.Label.Reset">
            <LINK PAGE_ID="BDMParticipant_selectTemplateCase">
               <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="wizardStateID" />
                  <TARGET NAME="PAGE" PROPERTY="wizardStateID" />
               </CONNECT>   
               <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="caseID" />
                  <TARGET NAME="PAGE" PROPERTY="caseID" />
               </CONNECT>  
                <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="concernRoleID" />
                  <TARGET NAME="PAGE" PROPERTY="concernRoleID" />
               </CONNECT>            
            </LINK>
         </ACTION_CONTROL>
         
         <ACTION_CONTROL IMAGE="CancelButton" LABEL="ActionControl.Label.Cancel" >
          <LINK PAGE_ID="BDMFEC_listCommunication">
       	   <CONNECT>
               <SOURCE NAME="PAGE" PROPERTY="concernRoleID" />
               <TARGET NAME="PAGE" PROPERTY="concernRoleID" />
            </CONNECT>
			<CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="caseID" />
                  <TARGET NAME="PAGE" PROPERTY="caseID" />
            </CONNECT>
           </LINK>
         </ACTION_CONTROL>
      </ACTION_SET>
   </CLUSTER>
   
    <JSP_SCRIPTLET>curam.omega3.texthelper.TextHelper th =
               (curam.omega3.texthelper.TextHelper)pageContext.findAttribute("DISPLAYCATEGORY");
          String dataStoreArray = th.getFieldValue("result$subCategoryArray");
          out.println("&lt;script type=\"text/javascript\"&gt;");
          out.println("var subCategory = " + dataStoreArray);
          out.println("&lt;/script&gt;");
   </JSP_SCRIPTLET> 
   
   <LIST TITLE="List.Title.Results">
      <CONTAINER LABEL="Container.Label.Action" WIDTH="15">
         <ACTION_CONTROL LABEL="ActionControl.Label.Select">
            <LINK DISMISS_MODAL="false" PAGE_ID="BDMParticipant_submitCorrespondenceCase" SAVE_LINK="false">
               <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="concernRoleID" />
                  <TARGET NAME="PAGE" PROPERTY="concernRoleID" />
               </CONNECT>
               <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="wizardStateID" />
                  <TARGET NAME="PAGE" PROPERTY="wizardStateID" />
               </CONNECT>
               <CONNECT>
                  <SOURCE NAME="ACTION" PROPERTY="templateID" />
                  <TARGET NAME="PAGE" PROPERTY="templateID" />
               </CONNECT>
			   <CONNECT>
                  <SOURCE NAME="PAGE" PROPERTY="caseID" />
                  <TARGET NAME="PAGE" PROPERTY="caseID" />
               </CONNECT>
            </LINK>
         </ACTION_CONTROL>
      </CONTAINER>
      <FIELD LABEL="Field.Label.TemplateName" WIDTH="60">
         <CONNECT>
            <SOURCE NAME="ACTION" PROPERTY="templateName" />
         </CONNECT>
      </FIELD>
      <FIELD LABEL="Field.Label.TemplateCategorySubCategory" WIDTH="60">
         <CONNECT>
            <SOURCE NAME="ACTION" PROPERTY="categoryAndSubCategory" />
         </CONNECT>
      </FIELD>
   </LIST>
   
</PAGE>