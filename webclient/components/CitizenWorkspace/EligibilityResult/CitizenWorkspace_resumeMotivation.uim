<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed Materials - Property of IBM
  
  Copyright IBM Corporation 2013, 2016. All Rights Reserved.
 
  US Government Users Restricted Rights - Use, duplication or disclosure 
  restricted by GSA ADP Schedule Contract with IBM Corp.
-->

<PAGE PAGE_ID="CitizenWorkspace_resumeMotivation">
  <JSP_SCRIPTLET>
  <![CDATA[
      // BEGIN 118764, PC 
      out.print("<script>top.CuramExternalApp.hideAppNavigation();</script>");      
      // END 118764 
      javax.servlet.http.HttpServletRequest hsRequest;
      javax.servlet.http.HttpSession httpSession;
      hsRequest = (javax.servlet.http.HttpServletRequest) request;
      httpSession = hsRequest.getSession();
      
      String context = request.getContextPath() + "/cw/";      
      
      String motivationID = request.getParameter("motivationID");
      httpSession.setAttribute("curam.motivationid", motivationID);
      
      String sessionID = request.getParameter("id");
      
      String navigatorID = (String) httpSession.getAttribute("curam.navigatorid");
      
      //call resume motivation 
      curam.interfaces.MotivationPkg.Motivation_resume_TH th = 
        new curam.interfaces.MotivationPkg.Motivation_resume_TH(); 
      th.setFieldValue(th.key$motivationID_idx, motivationID);    
      th.setFieldValue(th.key$navigatorID_idx, navigatorID);
      th.setFieldValue(th.key$sessionID_idx, sessionID);    
      th.callServer();
      
      String executionID = th.getFieldValue(th.result$scriptExecutionID_idx);
      String resumeScriptInd = th.getFieldValue(th.result$resumeScriptInd_idx);
      String resumeResultsInd = th.getFieldValue(th.result$resumeResultsInd_idx);

      if ("true".equals(resumeScriptInd)) {
      
        String url = context + "StartIEGScript.jspx?executionID=" + curam.omega3.request.RequestUtils.escapeURL(executionID); 
        // BEGIN 118764, PC 
        out.print("<script>window.location.href='" + url + "'</script>");
        // END 118764
      } else if ("true".equals(resumeResultsInd)) {
       out.print("<script>window.parent.displayContent({pageID:'CitizenWorkspace_eligibilityResults', param: [{paramKey:\"motivationID\", paramValue:\""
        + curam.omega3.request.RequestUtils.escapeURL(motivationID) + "\"}]})" + "</script>");
      } else {
        //redirect???
      }
    
     ]]>
  </JSP_SCRIPTLET>
</PAGE>
